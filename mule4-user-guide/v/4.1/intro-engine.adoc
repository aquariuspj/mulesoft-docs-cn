=  Mule 4简介：执行引擎线程和并发

Mule 4有一个改进的执行引擎，可以简化Mule应用程序的开发和扩展。底层引擎基于反应式，非阻塞体系结构。此面向任务的执行模型允许您利用非阻塞IO调用，并避免由于错误的处理策略配置而导致的性能问题。

从发展的角度来看，有一些重大变化：

*  Exchange模式不再存在。所有连接器都收到响应如果要异步处理消息，请使用Async组件。
* 每个流程始终使用非阻塞处理策略，并且不再需要配置处理策略。
* 所有流都有一个全局线程池。

== 控制并发
Mule 4将线程配置从并发管理中分离出来。要控制流或支持它的任何组件的并发性，请使用`maxConcurrency`属性设置组件可以在任何给定时间接收的同时调用数。

[source,xml,linenums]
----
<flow maxConcurrency=“1”>
  <http:listener>
  <scatter-gather maxConcurrency=“3”>
    <route/>
    <route/>
  </scatter-gather>
</flow>
----

== 线程池和调优应用程序

如上所述，现在应用中的所有流都有单个线程池。这将整体调优从流程特定行为中分离出来。 Mule根据你的机器有多少CPU核心来分配线程。您可以使用自我记录的`conf/scheduler-pools.conf`文件调整此线程数。

现在，每个Mule事件处理器都可以通知运行时是CPU密集型，CPU轻型还是IO密集型操作。这有助于运行时动态自动调整不同的工作负载，无需手动管理线程池。结果，Mule 4删除了复杂的调谐要求以实现最佳性能。
