=  Siebel连接器
= 主题标题
：许可证信息：企业

_Premium_

适用于Siebel的Anypoint Connector允许您访问Mule集成应用程序与Oracle Siebel客户关系管理器（CRM）之间的连接。

*Release Notes*： link:/release-notes/siebel-connector-release-notes[Siebel连接器发行说明]

连接器提供了这些选项以连接到Siebel应用程序：

*  *Oracle Siebel Business Objects*：创建，更新，插入，查询和删除Siebel业务组件。
*  *Oracle Siebel Integration Objects*：创建，更新，插入，查询，删除，查询页面，执行和同步Siebel集成对象。
*  *Oracle Siebel Business Services*：执行Siebel业务服务。

== 先决条件

由于连接器与Siebel CRM紧密相连，本文假设您具有Siebel业务组件，业务对象，业务服务和集成对象的工作知识。

本文假设您熟悉Mule， link:/mule-user-guide/v/3.7/anypoint-connectors[Anypoint连接器]和 link:/anypoint-studio/v/6/index[Anypoint Studio Essentials]为了提高您对Studio的熟悉度，请考虑完成一个或多个 link:/anypoint-studio/v/6/basic-studio-tutorial[Anypoint Studio教程]。此外，本页假定您对 link:/mule-user-guide/v/3.7/elements-in-a-mule-flow[骡流]和 link:/mule-user-guide/v/3.6/global-elements[骡全球元素]有基本的了解。

Siebel连接器需要以下两个Siebel JAR文件：`Siebel.jar`和`SiebelJI_xxx.jar`。

[NOTE]
根据Siebel安装的区域设置选择`SiebelJI_xxx.jar`。例如，如果Siebel安装的语言环境是US_EN，请使用`SiebelJI_enu.jar`。

`Siebel.jar`和`SiebelJI_enu.jar`在Siebel服务器上的`<%SIEBEL_HOME%>\8.1\Tools_1\CLASSES`文件夹中可用。 `%SIEBEL_HOME%`是Siebel的安装目录。

[NOTE]
您可以在配置Siebel全局元素的同时将JAR文件添加到您的Studio项目中。了解如何配置Siebel连接器全局元素。

== 兼容性

Siebel连接器与以下产品兼容：

[%header%autowidth.spread]
|===
|应用/服务 |版本
| *Mule Runtime*  | 3.6.1或更高版本
| *Siebel*  | V8.1
|===

[WARNING]
Siebel v2.1.0连接器是使用Oracle Siebel 8.1构建和测试的。由于Java Data Bean接口是通用的，因此Siebel v2.1.0连接器可与Siebel版本7.7,7.8和8.0配合使用。但是，连接器与8.1以外的任何其他版本的兼容性尚未经过测试。该连接器与Siebel v7.5及更低版本不兼容。

==  Siebel连接器体系结构

Siebel连接器使用Siebel Java Data Beans接口构建。 Java Data Beans提供了一个本地Java接口来访问Siebel对象管理器。

Siebel Object Manager允许连接器使用不依赖于定制安装的通用接口。要在设计时发现Siebel对象的元数据，请使用Anypoint Studio中的 link:/mule-user-guide/v/3.6/datasense[DataSense]。 Siebel连接器利用Siebel存储库在Siebel自定义安装中显示可用对象及其结构的列表。

对象可以是基于您配置的连接器选项的业务组件，业务对象，集成对象或业务服务。

以下是适用于Siebel的Anypoint连接器的集成架构：

image:Integration+architecture.png[集成+架构]

== 安装和配置

=== 安装

您可以使用 link:/anypoint-exchange[从Anypoint Exchange安装连接器]中的说明在Anypoint Studio中安装连接器。

要在生产环境中使用Siebel连接器，您必须具有：

* 使用Mule的企业许可证
*  CloudHub Starter，Professional或Enterprise帐户

请联系mailto：info@mulesoft.com [MuleSoft销售团队]安排授权。另请参阅 link:/mule-user-guide/v/3.7/installing-an-enterprise-license[安装企业许可证]。

Studio在调色板中显示三个新连接器：

*  *Oracle Siebel Business Objects*：连接到Siebel业务对象和组件。

*  *Oracle Siebel Business Services*：连接到Siebel业务服务。

*  *Oracle Siebel Integration Objects*：连接到Siebel集成对象。

=== 创建一个新项目

在Mule应用程序项目中使用Siebel连接器：

. 在Studio中，选择**File **> ** New **> ** Mule Project**。 image:PS_0001B_installing_new.png[PS_0001B_installing_new]

. 为您的新项目输入一个名称，并将其余选项保留为默认值。 +
  image:New+Project.png[新建项目+]

. 如果您打算使用Git，请针对Studio Projects的默认忽略项目选择**Create a .gitignore file**，然后单击*Next*。
. 点击*Finish*创建项目。

== 配置Siebel全局元素

要在Mule应用程序中使用Siebel连接器，必须为每个以下Siebel业务层配置全局元素：

*  Business Objects
* 商业服务
* 集成对象

===  Siebel Connector和DataSense

[NOTE]
====
如果您打算将Siebel连接器与 link:/anypoint-studio/v/5/datamapper-user-guide-and-reference[DataMapper转换器]结合使用来映射和转换数据，则可以使用Anypoint Studio的 link:/mule-user-guide/v/3.6/datasense[DataSense]功能。您可以启用DataSense作为配置全局元素的一部分。

* 按照DataSense指示信息将转换器放入流中，然后使用Siebel连接器将 link:/anypoint-studio/v/5/testing-connections[测试连接]转换为Siebel。
* 为了更好地体验DataMapper，请使用*XML Version*选择**XML Version 2 (DataMapper)**。
* 在您的流程中，在Siebel连接器之前或之后添加*DataMapper*，然后单击DataMapper转换器以显示DataMapper属性编辑器。从Siebel收集到元数据后，Mule会自动规定输入或输出（相对于Siebel连接器到DataMapper的位置）以映射和转换数据。
* 定义Siebel的特定映射，然后保存您的流程。
====

要在Mule应用程序中配置Siebel连接器全局元素：

[tabs]
------
[tab,title="Studio Visual Editor"]
....

. Click the *Global Elements* tab at the base of the canvas.
. On the Global Mule Configuration Elements screen, click *Create*.
. In the Choose Global Type wizard, expand *Connector Configuration*, and then select the connector you want to configure: *Oracle Siebel Business Objects* , *Oracle Siebel Business Services*, or *Oracle Siebel Integration Objects*.
+
image:connectorconfiguration.png[connectorconfiguration]

. Click *OK*
. Enter the global element properties:
.. For the Oracle Siebel Business Objects connector:
+
image:Business+Objects+Config.png[Business+Objects+Config]
+
[%header%autowidth.spread]
|===
|Field |Description
|*Name* |Enter a name to this connector to reference it later.
|*User* |Enter the Siebel username to use.
|*Password* |Enter the corresponding Siebel password.
|*Server* |Enter the server IP address of your Siebel instance.
|*Port* |Enter the port number.
|*Server Name* |Enter the Siebel Enterprise server name.
|*Object Manager* |Enter the value of the Object Manager of your Siebel instance. The default value is `EAIObjMgr_enu`.
|*Language* |Enter the language corresponding to the locale of the Siebel instance.
|*Encoding* |Enter an encoding type supported by the Siebel server.
|*Enable DataSense* |This option is selected by default. If you want to disable the option, click the check box to clear it.
|*DataSense Filters Business Components:* |
|*Default View Mode* a|Enter the default view for Data Sense. The default value for this field is 3. 

Supported values:

** *0 (SalesRepView):*
*** Applies access control according to a single position or a sales team.
*** Displays records according to one of the following items: The user position or the sales team that includes a user's position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
** *1 (ManagerView)*:
Displays records that a user and others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
** *2 (PersonalView)*:
Displays records that a user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.
** *3 (AllView)*:
Displays all records that includes a valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.

|*Data Sense Filter Query* a|Use this field to write a query to filter the Business Components metadata being downloaded into the application. 

[WARNING]
Limit the number of objects to retrieve through DataSense to a few objects using search specifications, otherwise retrieving metadata slows down Studio.

|*DataSense Filters Business Objects:* |
|*Default View Mode*
a|Use to set the visibility type for a business component. The Supported values:

* *0 (SalesRepView):* +
** Applies access control according to a single position or a sales team.
** Displays records according to one of the following items: The user position or the sales team that includes the user position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
* *1 (ManagerView):*
** Displays records that the user and the others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
* *2 (PersonalView)*: +
Displays records that the user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.
*  **3 (AllView)**: +
Displays all records that includes valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.
|*Data Sense Filter Query* a|Use this field to write a query to filter the Business Objects metadata being downloaded into the application.

[WARNING]
====
Limit the number of objects to retrieve through DataSense to a few objects using search specifications; otherwise retrieving metadata slows down Studio.
====

|*Required Dependencies* a|Click *Add File* to browse to and attach the required jar files to your project's Build path. 

image:requireddependencies1.png[requireddependencies1]

After the jar files are attached, they appear in the `lib\siebel` directory of your project's root folder.

image:required+dependencies.png[required+dependencies]

If you provide the wrong files (either an invalid jars or a completely different library), Studio displays the following error message: 

image:depedencies+error.png[depedencies+error]
|===

.. For the Siebel Business Services connector:
+
image:businessservicesconfig.png[businessservicesconfig]
+
[%header,cols="2*"]
|===
|Field |Description
|*Name* |Enter a name to this connector to reference it later.
|*User* |Enter the Siebel username you want to use for this configuration.
|*Password* |Enter the corresponding Siebel password.
|*Server* |Enter the server IP address of your Siebel instance.
|*Port* |Enter the port number.
|*Server Name* |Enter the Siebel Enterprise server name.
|*Object Manager* |Enter the value of the Object Manager of your Siebel instance. This defaults to `EAIObjMgr_enu`.
|*Language* |Enter the language corresponding to the locale of the Siebel instance.
|*Encoding* |Enter an encoding type supported by the Siebel server.
|*Enable DataSense* |This option is selected by default. If you want to disable the option, click the box to clear it.
|*Default View Mode* a|
Default View Mode is 3. It is used to set the visibility type for a business service.

Supported values:

* *0 (SalesRepView):* +
** Applies access control according to a single position or a sales team.
** Displays records according to one of the following items: The user position or the sales team that includes the user position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
* **1 (ManagerView)**: +
Displays records that the user and the others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
* *2 (* **PersonalView)**: +
Displays records that the user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.
* **3 (AllView)**: +
Displays all records that includes valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.

|*Data Sense Filter Query* a|
Use this field to write a query to filter the Business Services metadata being downloaded into the application. 

[WARNING]
Limit the number of objects to retrieve through DataSense to a few objects using search specifications, otherwise retrieving metadata slows down Studio. The Siebel Vanilla installation comes with 8000 predefined objects versus 350 in SFDC.

|*Required Dependencies* a|
Click *Add File* to attach required jar files to your project's Build path. 

image:requireddependencies1.png[requireddependencies1]

After the jar files are attached, they appear in the lib/siebel directory of your project's root folder.

image:required+dependencies.png[required+dependencies]

If you provide the wrong files (either an invalid jars or a completely different library), Studio displays the following error message: 

image:depedencies+error.png[depedencies+error]
|===

.. For the Siebel Integration Objects connector:
+
image:integrationobjectconfig.png[integrationobjectconfig]
+
[%header,cols="2*"]
|===
|Field |Description
|*Name* |Enter a name to this connector to reference it later.
|*User* |Enter the Siebel username you want to use for this configuration.
|*Password* |Enter the corresponding Siebel password.
|*Server* |Enter the server IP address of your Siebel instance.
|*Port* |Enter the port number.
|*Server Name* |Enter the Siebel Enterprise server name.
|*Object Manager* |Enter the value of the Object Manager of your Siebel instance. This defaults to `EAIObjMgr_enu`.
|*Language* |Enter the language corresponding to the locale of the Siebel instance.
|*Encoding* |Enter an encoding type supported by the Siebel server.
|*Enable DataSense* |This option is selected by default. If you want to disable the option, click the box to clear it.
|*Default View Mode* a|
The default value for this field is 3. It is used to set the visibility type for a integration object.

Supported values:

* *0 (SalesRepView):* +
** Applies access control according to a single position or a sales team.
** Displays records according to one of the following items: The user position or the sales team that includes the user position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
* **1 (ManagerView)**: +
Displays records that the user and the others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
* *2 (* **PersonalView)**: +
Displays records that the user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.  +
* **3 (AllView)**: +
Displays all records that includes valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.

|*Data Sense Filter Query* a|
Use this field to write a query to filter the Integration Objects metadata being downloaded into the application. 

[WARNING]
Limit the number of objects to retrieve through DataSense to a few objects using search specifications; otherwise retrieving metadata slows down Studio. The Siebel Vanilla installation comes with 8000 predefined objects versus 350 in SFDC.

|*Data Sense Flat Fields* a|
Select this box to allow Studio to flatten the object for DataSense purposes.

[WARNING]
Anypoint Studio doesn't support hierarchical objects.

|*Required Dependencies* a|Click *Add File* to attach required jar files to your project's Build path.
image:requireddependencies1.png[requireddependencies1] After jar files are attached, they appear in the `lib/siebel` directory of your project's root folder.
image:required+dependencies.png[required+dependencies] If you provide the wrong files (either an invalid jars or a completely different library), Studio displays the following error message:  image:depedencies+error.png[depedencies+error]
|===

. Keep the **Pooling Profile **and the *Reconnection* tabs with their default entries.

. Click *Test Connection* to confirm that the parameters of your global Siebel connector are accurate, and that Mule is able to successfully connect to your instance of Siebel. Read more about link:/anypoint-studio/v/5/testing-connections[Testing Connections].

. Click *OK* to save the global connector configurations. 

....
[tab,title="XML Editor"]
....

. To configure the Siebel Business Objects connector:

.. Ensure you have included the following namespaces in your configuration file:
+
[source, xml, linenums]
----
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:siebel="http://www.mulesoft.org/schema/mule/siebel"
      xsi:schemaLocation="
               http://www.mulesoft.org/schema/mule/core
               http://www.mulesoft.org/schema/mule/core/current/mule.xsd
               http://www.mulesoft.org/schema/mule/siebel
               http://www.mulesoft.org/schema/mule/siebel/current/mule-siebel.xsd">
      <!-- here goes your flows and configuration elements -->
</mule>
----
.. Create a global Siebel Business Object configuration outside and above your flows, using the following global configuration code:
+
[source, xml, linenums]
----
<siebel:config name="Oracle_Siebel_Business_Object" user="${siebel.user}" password="${siebel.password}" server="${siebel.server}" serverName="${siebel.servername}" objectManager="${siebel.mgr}" dataSenseFilterQueryBusComp="[Name] = 'Action_IO' OR [Name] = 'Contact_IO'" dataSenseFilterQueryBusObjects="[Name] = 'Action_IO' OR [Name] = 'Contact_IO'" doc:name="oracle siebel business objects">
----
+
[%header,cols="2*"]
|===
|Parameter |Description
|*name* |Enter a name for this connector to reference it later.
|*user* |Enter the Siebel username to use.
|*password* |Enter the corresponding Siebel password.
|*server* |Enter the server IP address of your Siebel instance.
|*serverName* |Enter the Siebel Enterprise server name.
|*objectManager* |Enter the value of the Object Manager of your Siebel instance. This defaults to `EAIObjMgr_enu`.
|*dataSenseFilterQueryBusComp* |Write a query to filter the Business Components metadata being downloaded into the application.
|*defaultViewModeBusComp* a|
Enter the default view for DataSense purposes. The default value for this field is 3. 

Supported values:

* *0 (SalesRepView):* +
** Applies access control according to a single position or a sales team.
** Displays records according to one of the following items: The user position or the sales team that includes a user's position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
* **1 (ManagerView)**:
** Displays records that a user and others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
* *2 (* **PersonalView)**: +
Displays records that a user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.
* **3 (AllView)**: +
Displays all records that includes a valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.

|*dataSenseFilterQueryBusObjects* a|
Write a query to filter the Business Objects metadata being downloaded into the application.

|*defaultViewModeBusObjects* a|
Use to set the visibility type for a business component. Supported values:

* *0 (SalesRepView):* +
** Applies access control according to a single position or a sales team.
** Displays records according to one of the following items: The user position or the sales team that includes the user position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
* *1 (ManagerView): +
 Displays records that the user and the others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
* *2 (* **PersonalView)**: +
Displays records that the user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.
* **3 (AllView)**: +
Displays all records that includes valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.
|===

. *To configuring the Siebel Business Services Connector:*
.. Ensure you have included the following namespaces in your configuration file:
+
[source, xml, linenums]
----
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:siebel-bs="http://www.mulesoft.org/schema/mule/siebel-bs"
      xsi:schemaLocation="
               http://www.mulesoft.org/schema/mule/core
               http://www.mulesoft.org/schema/mule/core/current/mule.xsd
               http://www.mulesoft.org/schema/mule/siebel-bs
               http://www.mulesoft.org/schema/mule/siebel-bs/current/mule-siebel-bs.xsd">
      <!-- here goes your flows and configuration elements -->
</mule>
----

.. Create a global Siebel Business Services configuration outside and above your flows, using the following global configuration code.
+
[source, xml, linenums]
----
<siebel-bs:config name="Oracle_Siebel_Business_Services__Connection" user="${siebel.user}" password="${siebel.password}" server="${siebel.server}" serverName="${siebel.servername}" objectManager="${siebel.mgr}" dataSenseFilterQuery="${siebel.filterBusComp}" doc:name="Oracle Siebel Business Services: Connection" fileEncoding="${siebel.encoding}" language="${siebel.language}" port="${siebel.port}"/>
----
+
[%header,cols="2*"]
|===
|Field |Description
|*Name* |Enter a name for this connector to reference it later.
|*user* |Enter the Siebel username to use.
|*password* |Enter the corresponding Siebel password.
|*server* |Enter the server IP address of your Siebel instance.
|*serverName* |Enter the Siebel Enterprise server name.
|*objectManager* |Enter the value of the Object Manager of your Siebel instance. This defaults to `EAIObjMgr_enu`.
|*language* |Enter the language corresponding to the locale of the Siebel instance.
|*fileEncoding* |Enter an encoding type supported by the Siebel server.
|*dataSenseFilterQuery* a|
Use this field to write a query to filter the Business Services metadata being downloaded into the application. 

[WARNING]
Limit the number of objects to retrieve through DataSense to a few objects using search specifications, otherwise retrieving metadata slows down Studio. The Siebel Vanilla installation comes with 8000 predefined objects versus 350 in SFDC.

|*defaultViewMode* a|
It is used to set the visibility type for a business service.

Supported values:

* *0 (SalesRepView):* +
** Applies access control according to a single position or a sales team.
** Displays records according to one of the following items: The user position or the sales team that includes the user position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
* **1 (ManagerView)**: +
Displays records that the user and the others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
* *2 (* **PersonalView)**: +
Displays records that the user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.
* **3 (AllView)**: +
Displays all records that includes valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.
|===

. *To configure the Siebel Integration Objects connector:*

.. Ensure you have included the following namespaces in your configuration file:
+
[source, xml, linenums]
----
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:siebel-io="http://www.mulesoft.org/schema/mule/siebel-io"
      xsi:schemaLocation="
               http://www.mulesoft.org/schema/mule/core
               http://www.mulesoft.org/schema/mule/core/current/mule.xsd
               http://www.mulesoft.org/schema/mule/siebel-io
               http://www.mulesoft.org/schema/mule/siebel-io/current/mule-siebel-io.xsd">
      <!-- here goes your flows and configuration elements -->
</mule>
----

.. Create a global Siebel Integration Objects configuration outside and above your flows, using the following global configuration code:
+
[source, xml, linenums]
----
<siebel-io:config name="Oracle_Siebel_Integration_Objects__Connection" user="${siebel.user}" password="${siebel.password}" server="${siebel.server}" serverName="${siebel.servername}" objectManager="${siebel.mgr}" dataSenseFilterQuery="${siebel-io.dataSenseFilterQuery}" doc:name="Oracle Siebel Integration Objects: Connection" fileEncoding="${siebel.encoding}" language="${siebel.language}" port="${siebel.port}"/>
----
+
[%header,cols="2*"]
|===
|Field |Description
|*name* |Enter a name for this connector to reference it later.
|*user* |Enter the Siebel username to use.
|*password* |Enter the corresponding Siebel password.
|*server* |Enter the server IP address of your Siebel instance.
|*serverName* |Enter the Siebel Enterprise server name.
|*objectManager* |Enter the value of the Object Manager of your Siebel instance. The default value is `EAIObjMgr_enu`.
|*language* |Enter the language corresponding to the locale of the Siebel instance.
|*fileEncoding* |Enter an encoding type supported by the Siebel server.
|*dataSense FilterQuery* a|
Use this field to write a query to filter the Integration Objects metadata being downloaded into the application. 

[WARNING]
Limit the number of objects to retrieve through DataSense to a few objects using search specifications; otherwise retrieving metadata slows down Studio. The Siebel Vanilla installation comes with 8000 predefined objects versus 350 in SFDC.

|*defaultViewMode* a|
Use this field to set the visibility type for a integration object.

Supported values:

* *0 (SalesRepView):* +
** Applies access control according to a single position or a sales team.
** Displays records according to one of the following items: The user position or the sales team that includes the user position. The *Visibility* field or *Visibility MVField* of the business component determines the visibility. 
* **1 (ManagerView)**: Displays records that the user and the others who report to the user can access. For example, it includes the records that Siebel CRM displays in the My Team's Accounts visibility filter. 
* *2 (* **PersonalView)**: +
Displays records that the user can access, as determined by the *Visibility Field* property of the *BusComp* view mode object. For example, it includes the records that Siebel CRM displays in the My Accounts visibility filter.
* **3 (AllView)**: +
Displays all records that includes valid owner. For example, it includes the records that Siebel CRM displays in the All Accounts Across Organizations visibility filter.
|===

....
------

== 使用连接器

Siebel连接器是基于操作的连接器，这意味着将Siebel连接器添加到流中时，需要配置连接器执行的特定操作。

=== 用例

以下是Siebel连接器的常见用例：

* 定期为新注册管理机构轮询Siebel连接器并将输出发送到Salesforce。
* 定期轮询Salesforce连接器以获取新注册表并将输出发送到Siebel。

=== 将Oracle Siebel Business Objects连接器添加到流程中

. 在Anypoint Studio中创建一个新的Mule项目。
. 添加合适的Mule入站端点，例如HTTP入站端点或文件端点，以开始流程。
. 将** **业务对象连接器拖放到画布上，然后选择它以打开属性编辑器。
. 根据下表配置连接器的参数。
+
image:oracl+business+objects+connector.jpeg[ORACL +商业+对象+连接器]
+
[%header%autowidth.spread]
|===
|字段 |描述 |默认值
| *Display Name*  |为应用程序中的连接器输入唯一标签。 | `Oracle Siebel Business Objects`
| *Connector Configuration*  |选择您创建的全局Siebel连接器元素。 |
| *General:*  |  |
3. + A |
[NOTE]
====
“常规”部分中的值因您选择的操作而异。以下字段特定于查询业务组件操作。
====
| *Sort specification*  |为查询返回的业务组件列表指定排序标准。|
| *Business Object Component Type*  |定义要对其执行操作的Siebel业务对象类型。 Siebel Jdb连接器可以访问Siebel CRM中可用的许多业务对象中的任何一个。|
| *Search Expression*  | 使用 link:/mule-user-guide/v/3.7/mule-expression-language-mel[骡子表达语言（MEL）]定义将返回业务组件列表的搜索表达式。 |
| *View Mode*  |为连接器返回的结果定义Siebel视图模式。|  `3`
| *Fields to Retrieve* a |使用此部分指定要在查询中检索的字段列表：

*From Message:*指定要在传入有效内容中检索的业务组件字段。

*Create Object manually:*使用Object Builder编辑器手动指定字段。|  `From Message`
| *Search Spec* a |指定在搜索查询中用作过滤器的搜索值：

*From Message:*定义在传入有效内容中将哪些值用作搜索过滤器。

*Create Object manually:*使用Object Builder编辑器手动定义要用作搜索过滤器的值。 |
3。+ | *Generic:*
| *Operation*  |定义此组件必须执行的操作：创建，删除，更新，插入，插入或查询业务组件 | `Create Business Component`
|===

. 单击画布上的空白区域以保存您的Oracle Siebel业务对象连接器配置。

=== 将Oracle Siebel业务服务连接器添加到流程中

. 在Anypoint Studio中创建一个新的Mule项目。
. 添加合适的Mule入站端点，例如HTTP入站端点或文件端点，以开始流程。
. 将** **业务服务连接器拖放到画布上，然后选择它以打开属性编辑器。
. 根据下表配置连接器的参数。 +
image:oraclebusinessservices.jpeg[oraclebusinessservices]

[%header%autowidth.spread]
|===
|字段 |描述 |默认值
| *Display Name*  |为应用程序中的连接器定义唯一的标签。 | `Oracle Siebel Business Services`
| *Connector Configuration*  |选择您创建的全局Siebel连接器元素。 |
| *Operation* a |定义此组件必须执行的操作：

**  *Execute*：使用SiebelPropertySets执行Siebel服务。

**  *Execute business service*：使用地图代替SiebelPropertySet执行Siebel服务。|
3。+ | *General*
3。+ |如果您选择*Execute*操作：
| *Method Name*  |输入要执行的方法的名称。 |
| *Service Name*  |输入要执行的Siebel服务的名称 |
| *Input Properties* a |
*From Message:*在传入负载中定义SiebelPropertySet。

*Create Object manually:*手动定义SiebelPropertySet |
3。+ |如果您选择*Execute business service*操作：
| *Business Service*  |输入要执行的Siebel服务的名称。 |
| *Input* a |
*From Message:*指定要在传入有效内容中执行的服务。

*Create Object manually:*指定要手动执行的服务。|
|===

单击画布上的空白区域以保存Oracle Siebel业务服务连接器配置。

=== 将Oracle Siebel集成对象连接器添加到流程中

. 在Anypoint Studio中创建一个新的Mule项目。
. 添加合适的Mule入站端点，例如HTTP入站端点或文件端点，以开始流程。
. 将** **业务对象连接器拖放到画布上，然后选择它以打开属性编辑器。
. 根据下表配置连接器的参数。
+
image:io22.jpeg[io22]
+
[%header%autowidth.spread]
|===
|字段 |描述 |默认值
| *Display Name*  |为应用程序中的连接器定义唯一的标签。 | `Oracle Siebel Business Services`
| *Connector Configuration*  |选择您创建的全局Siebel连接器元素。 |
| *Operation* a |定义此组件必须执行的操作：执行Siebel Adapter。| `Executes Siebel Adapter`
3。+ | *General*
| *Integration Object*  |定义Siebel集成对象类型以对|
进行处理
| *Method*  |定义EAI Siebel适配器方法。 |
| *Input Properties* a |
*From Message:*映射传入有效负载中的集成对象字段。

*Create Object manually:*手动定义SiebelPropertySet |  `From Message`
|===

. 单击画布上的空白区域以保存您的Oracle Siebel业务对象连接器配置。

== 示例使用案例1

定期轮询Siebel连接器，查找新注册表并将输出发送到Salesforce。

[NOTE]
有关这些Mule元素的详细信息，请参阅 link:/mule-user-guide/v/3.6/poll-reference[投票范围]， link:/anypoint-studio/v/5/datamapper-user-guide-and-reference[的DataMapper]和 link:/mule-user-guide/v/3.7/salesforce-connector[Salesforce连接器]中的文档。

[tabs]
------
[tab,title="Studio Visual Editor"]
....

image:example+use+case.jpeg[example+use+case]

. Drag a *Poll Scope* into a new flow.
+  image:poll2.jpeg[poll2]
+
A link:/mule-user-guide/v/3.6/poll-reference[Poll Scope] executes any Mule element you place inside it, at regular intervals. In this case, it is a Siebel endpoint.

. Configure the Poll Scope as follows
+
image:pollnew.jpeg[pollnew]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Frequency* |60000
|*Start Delay* |0
|*Time Unit* |MILLISECONDS
|*Enable Watermark* |check
|*Variable Name* |lastUpdate
|*Default Expression* |`#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID("PST8PDT")).minusSeconds(5).toString("MM/dd/yyyy HH:mm:ss")]`
|*Update Expression* |`#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID("PST8PDT")).minusSeconds(5).toString("MM/dd/yyyy HH:mm:ss")]`
|===
+
The poll scope triggers once a minute. The watermark ensures that registries in the Siebel DB aren't processed more than once. It does this by keeping track of  the last element processed in the last poll.
+
[NOTE]
To learn how watermarks work and what each attribute is for, read about  link:/runtime-manager/managing-schedules[Poll Schedulers].

. Drag an *Oracle Siebel Business Objects* connector into the space provided by the Poll Scope.
+
image:poll.jpeg[poll] 
+
The Siebel connector is now polled at the intervals you specified in the Poll Scope.

. Open Siebel connector's properties editor, and next to the Config Reference field, click the *+* sign to add a new *Global Element.*
+
image:boconfig.jpeg[boconfig]

. On the Global Element Properties window, configure the global element according to the settings below:
image:config.jpeg[config]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Name* |Oracle_Siebel_Business_Object
|*User* |<Your Siebel user name>
|*Password* |<Your Siebel password>
|*Port* |<Port you're using>
|*Server Name* |<Server name on which the Siebel instance is hosted>
|*Object Manager* |<Object manager you use>
|*Default View Mode* |3
|*Data Sense Filter Query* |[Name] = 'Action_IO' OR [Name] = 'Contact_IO'
|*Default View Mode* |3
|*Data Sense Filter Query* |[Name] = 'Action_IO' OR [Name] = 'Contact_IO'
|===
+
[WARNING]
DataSense is filtered via a query to extract data only from Contacts and Action. This aids better performance by avoiding unnecessary data extraction.

. Click *Test Connection* at the bottom of the window to ensure that everything is correctly configured.
. Next, configure the Oracle Siebel Business Objects connector according to the settings below:
+
image:boconfig1.jpeg[boconfig1]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Display Name* |Oracle Siebel business objects
|*Connector Configuration* |Oracle_Siebel_Business_Object
|*Business Object Component Type* |Contact.Contact
|*Search Expression* |`[Last Update - SDQ] > '#[flowVars.lastUpdate]'`
|*View Mode* |3
|*fields-to-retrieve* |Create Object Manually
|*search-spec* |None
|*Operation* |Query business components
|===
+
*Note*: The search expression uses the same variable that is being updated by the Poll Scope. In this way, the Siebel connector returns only those DB records that Mule hasn't processed in the last poll.
+
[%header,cols="2*"]
|===
|Child Element |Description
|`siebel:fields-to-retrieve` |Lists the output fields of the query
|===

. To set up the structure of the output message, switch views to the Studio XML Editor. Look for the Siebel connector in your XML code in a tag that looks like the tag below:
+
[source, xml, linenums]
----
<siebel:query-business-components config-ref="Oracle_Siebel_Business_Object" businessObjectComponentType="Contact.Contact" searchExpression="[Last Update - SDQ] &gt; '#[flowVars.lastUpdate]'" doc:name="oracle siebel business objects">
            </siebel:query-business-components>
----
+
In between the start and end tags of the  `siebel:query-business-components` , add the following child element structure:
+
[source, xml, linenums]
----
<siebel:fields-to-retrieve>
    <siebel:fields-to-retrieve>Last Name</siebel:fields-to-retrieve>
    <siebel:fields-to-retrieve>Email Address</siebel:fields-to-retrieve>
    <siebel:fields-to-retrieve>First Name</siebel:fields-to-retrieve>
    <siebel:fields-to-retrieve>Primary Organization</siebel:fields-to-retrieve>
    <siebel:fields-to-retrieve>Personal Contact</siebel:fields-to-retrieve>
    <siebel:fields-to-retrieve>Employee Number</siebel:fields-to-retrieve>
    <siebel:fields-to-retrieve>Account Integration Id</siebel:fields-to-retrieve>
</siebel:fields-to-retrieve>
----

. Drag a *Logger* after the Poll to register the Poll output.
+
image:logger.jpeg[logger]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Message* |`Polling from Siebel #[payload]`
|*Level* |Info
|===

. Drag a *Salesforce Connector* after the Logger. It uploads the output of the poll into your Salesforce account. +
  image:salesforce.jpeg[salesforce]

. Open the Properties editor of the Salesforce connector, and click the *+* sign to add a new Salesforce global element. +
*{{0}}*

. On the Choose Global Type window, click **Salesforce: Basic authentication**, and then click *Ok*.
+
image:sfbasicauth.jpeg[sfbasicauth]

. Configure the Salesforce global element properties:
+
image:Salesconfig.jpeg[Salesconfig]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Name* |Salesforce
|*Username* |<Your user name>
|*Password* |<Your password>
|*Security Token* |<Your Token>
|*Url* |<The URL on which your Salesforce account is hosted>
|*Proxy Port* |80
|*Enable DataSense* |check
|===

. Click *Test Connection* to ensure that everything is correctly configured.
. Configure the Salesforce connector according to the settings below:
+
image:salesforce2.jpeg[salesforce2]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Display Name* |Salesforce
|*Connector Configuration* |Salesforce
|*Operation* |Create
|*sObject Type* |contact
|*sObjects* |`From Message:#[payload]`
|===
. Add a *Data Mapper* element between the Logger and the Salesforce connector. It maps fields from the data structure returned by Siebel into the data structure required by Salesforce. +
image:datamapper.jpeg[datamapper]

. Configure the *Data Mapper* element:
+
[TIP]
If you have already configured both connectors properly, DataMapper automatically suggests the mapping you need to make.
+
Input:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Type* |Connector
|*Connector* |`Oracle_Siebel_Business_Object`
|*Operation* |`query-business-components`
|*Object* |List<Contact.Contact>
|===
+
Output:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Type* |Connector
|*Connector* |Salesforce
|*Operation* | create
|*Object* | List<Contact>
|===

. Click *Create mapping* for the DataMapper to build a mapping between both the data structures.

. The following fields don't have the same names in Salesforce and Siebel. You need to configure them manually.
+
[%header%autowidth.spread]
|===
|Name in Siebel |Name in Salesforce
|*Email_Address* |Email
|*First_Name* |FirstName
|*Last_Name* |LastName
|===
. There are two ways you can link these: +
.. Look for the fields on both columns in **DataLoader's graphical view**, then simply drag and drop one onto the other.
+
[TIP]
This is usually the easiest way to go, but given the number of fields to navigate, it may be hard to find the fields you need. Use the search box above the field list to find these quickly.
.. Enter *DataLoader's Script view* and paste the following lines of code below what is already written:
+
[source, code, linenums]
----
output.Email = input.Email_Address;
output.FirstName = input.First_Name;
output.LastName = input.Last_Name;
----
+
The full code should look like this:
+
[source, code, linenums]
----
//MEL
//START -> DO NOT REMOVE
output.__id = input.__id;
//END -> DO NOT REMOVE
output.Department = input.Department;
output.Email = input.Email_Address;
output.FirstName = input.First_Name;
output.LastName = input.Last_Name;
----

. Add a *Logger* at the end of the flow to register the outcome of the operation:
+
image:Siebel+to+Salesforce.jpeg[Siebel+to+Salesforce]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Message* |`#[payload.toString()]`
|*Level* |Info
|===

. Save and run the project as a Mule Application.

....
[tab,title="XML Editor"]
....

. At the start of your project, add a Salesforce Global Element to set up global configuration attributes for this connector:
+
[source, xml, linenums]
----
<sfdc:config name="Salesforce" username="${salesforce.user}" password="${salesforce.password}" securityToken="${salesforce.securitytoken}" url="${salesforce.url}" doc:name="Salesforce">
<sfdc:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
</sfdc:config>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|*sfdc:config* |Configures connection settings for Salesforce
|===
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*name* |Salesforce
|*username* |<Your username>
|*password* |<Your password>
|*security token* |<Your security token>
|*url* |<The URL on which your Salesforce account is hosted>
|*doc:name* |Salesforce
|===
+
[%header%autowidth.spread]
|===
|Child Element |Description
|*sfdc:connection-pooling-profile* |Configures connection pooling settings for connecting to Salesforce
|===
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*initialisationPolicy* |INITIALISE_ONE
|*exhaustedAction* |WHEN_EXHAUSTED_GROW
|===
. After the Salesforce Global Element, add a *Siebel Global Element* to set up global configuration attributes for this connector:
+
[source, xml, linenums]
----
<siebel:config name="Oracle_Siebel_Business_Object" user="${siebel.user}" password="${siebel.password}" server="${siebel.server}" serverName="${siebel.servername}" objectManager="${siebel.mgr}" dataSenseFilterQueryBusComp="[Name] = 'Action_IO' OR [Name] = 'Contact_IO'" dataSenseFilterQueryBusObjects="[Name] = 'Action_IO' OR [Name] = 'Contact_IO'" doc:name="oracle siebel business objects">
       <siebel:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
    </siebel:config>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|*siebel:config* | Configures connection settings for Siebel
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`name` a|`Oracle_Siebel_Business_Object`
a|`user` |<Your user name>
a|`password` |<Your password>
a|`server` |<The IP address of your Siebel server>
a|`serverName` |<The Siebel Enterprise server name>
a|`objectManager` |<The object manager you use>
a|`dataSenseFilterQueryBusComp` a|`[Name] = 'Action_IO' OR [Name] = 'Contact_IO'`
a|`dataSenseFilterQueryBusObjects` a|`[Name] = 'Action_IO' OR [Name] = 'Contact_IO'`
a|`doc:name` a|`oracle siebel business objects`
|===
+
[%header%autowidth.spread]
|===
|Child Element |Description
|`siebel:connection-pooling-profile` | Configures connection pooling settings for connecting to Siebel
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`initialisationPolicy` |INITIALISE_ONE
a|`exhaustedAction` |WHEN_EXHAUSTED_GROW 
|===

. Build a new **Flow:**
+
[source, xml, linenums]
----
<flow name="Poll_Siebel_2_Salesforce" doc:name="Poll_Siebel_2_Salesforce" processingStrategy="synchronous">
    </flow>
----

. Add a *Poll Scope* inside your new Flow.
+
[source, xml, linenums]
----
<poll doc:name="Poll">
    <fixed-frequency-scheduler frequency="60000"/>
    <watermark variable="lastUpdate" default-expression="#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5).toString(&quot;MM/dd/yyyy HH:mm:ss&quot;)]" update-expression="#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5).toString(&quot;MM/dd/yyyy HH:mm:ss&quot;)]"/>
</poll>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|*poll* |A Poll Scope executes the Mule element you place inside it at regular intervals. In this case, it will be a Siebel endpoint.
|===
+
[%header,cols="2*"]
|===
|Child Element |Description
|`fixed-frequency-scheduler` |Sets the interval for polling
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|frequency |6000
|===
+
The poll scope triggers once a minute. The watermark ensures that registries in the Siebel DB aren't processed more than once. It does so by keeping track of  the last element processed in the last poll.
+
[%header,cols="2*"]
|===
|Child Element |Description
a|`watermark` |The watermark ensures that registries in the Siebel DB aren't processed more than once by keeping track of what was the last element that was processed in the last poll.
|===
+
[NOTE]
To learn how watermarks work and what each attribute is for, read about link:/runtime-manager/managing-schedules[Poll Schedulers].
+
[%header%autowidth.spread]
|===
|Attribute |Value
a|`variable` |lastUpdate
|default-expression |#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5).toString(&quot;MM/dd/yyyy HH: mm:ss&quot ;)]
|update-expression |#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5).toString(&quot;MM/dd/yyyy HH:mm:ss&quot;)]
|===

. Inside this Poll Scope, add a **Siebel:query-business-components** element
+
[source, xml, linenums]
----
<siebel:query-business-components config-ref="Oracle_Siebel_Business_Object" businessObjectComponentType="Contact.Contact" searchExpression="[Last Update - SDQ] &gt; '#[flowVars.lastUpdate]'" doc:name="oracle siebel business objects">
    <siebel:fields-to-retrieve>
        <siebel:fields-to-retrieve>Last Name</siebel:fields-to-retrieve>
        <siebel:fields-to-retrieve>Email Address</siebel:fields-to-retrieve>
        <siebel:fields-to-retrieve>First Name</siebel:fields-to-retrieve>
        <siebel:fields-to-retrieve>Primary Organization</siebel:fields-to-retrieve>
        <siebel:fields-to-retrieve>Personal Contact</siebel:fields-to-retrieve>
        <siebel:fields-to-retrieve>Employee Number</siebel:fields-to-retrieve>
        <siebel:fields-to-retrieve>Account Integration Id</siebel:fields-to-retrieve>
    </siebel:fields-to-retrieve>
</siebel:query-business-components>
----
+
The Siebel connector polls at the intervals you specified in the Poll Scope:
+
[%header,cols="2*"]
|===
|Element |Description
a|siebel:query-business-components
|Connects to Siebel Business Components
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`config-ref` a|Oracle_Siebel_Business_Object
a|`businessObjectComponentType` a|Contact.Contact
a|`searchExpression` a|`[Last Update - SDQ] &gt; '#[flowVars.lastUpdate]`
a|`doc:name` a|oracle siebel business objects
|===
+
[%header,cols="2*"]
|===
|Child Element |Description
a|`siebel:fields-to-retrieve`
|Lists the output fields of the query
|===
. After the Poll Scope, add a Logger to verify the output of this poll:
+
[source, xml, linenums]
----
<logger message="Polling from Siebel #[payload]" level="INFO" doc:name="Logger"/>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|logger |Logs messages to the Mule console
|===
+
[%header%autowidth.spread]
|===
|Attribute |Value
|Message |`Polling from Siebel #[payload]`
|Level |Info
|===

. Add a Salesforce connector after this logger. It uploads the output of the poll into your Salesforce account.
+
[source, xml, linenums]
----
<sfdc:create config-ref="Salesforce" type="Contact" doc:name="Salesforce">
    <sfdc:objects ref="#[payload]"/>
</sfdc:create>
----
+
[%header,cols="2*"]
|===
|Element |Description
a|sfdc:create |Creates a contact entry on the specified Salesforce account
|===
+
[%header,cols="2*"]
|===
|Attribute |Values
a|config-ref |Salesforce
a|type |Contact
a|doc:name |Salesforce
|===
+
[%header,cols="2*"]
|===
|Child Element |Description
a|sfdc:objects |Defines what structure the created object will have
|===
+
[%header,cols="2*"]
|===
|Attribute |Values
a|ref  a|#[payload]
|===
. Add another logger after the Salesforce connector to verify the success of the operation.
+
[source, xml, linenums]
----
<logger message="#[payload.toString()]" level="INFO" doc:name="Logger"/>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|logger |Logs messages to the Mule console
|===
+
[%header%autowidth.spread]
|===
|Attribute |Value
|Message |`#[payload.toString()]`
|Level |Info
|===
. Add a *DataMapper* *component* between the first logger and the Salesforce connector. It maps fields from the data structure returned by Siebel into the data structure required by Salesforce
+
[source, xml, linenums]
----
<data-mapper:transform doc:name="DataMapper"/>
----

. Switch to Studio Visual editor to configure DataMapper correctly. Click on the DataMapper icon to edit its fields:
+
[TIP]
If you have already configured both connectors properly, DataMapper should be able to automatically suggest the mapping you need to make.
+
Input:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Type* |Connector
|*Connector* |Oracle_Siebel_Business_Object
|*Operation* |`query-business-components`
|*Object* |`List<Contact.Contact>`
|===
+
Output:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Type* |Connector
|*Connector* |Salesforce
|*Operation* |create
|*Object* |`List<Contact>`
|===
. Click *Create mapping* for DataMapper to build a mapping between both data structures.
. A few fields don't have the same names in Salesforce as they do in Siebel. You must configure them manually.
+
[%header%autowidth.spread]
|===
|Name in Siebel |Name in Salesforce
|Email_Address |Email
|First_Name |FirstName
|Last_Name |LastName
|===
+
There are two ways in which you can link these:
+
.. Look for the fields on both columns in **DataLoader's graphical view**, then simply drag and drop one onto the other.
+
[TIP]
This is usually the easiest way to go, but given the number of fields to navigate, it may be hard to find the fields you need. Use the search box above the field list to find these quickly.
.. Enter **DataLoader's Script view** and paste the following lines of code below what is already written:
+
[source, code, linenums]
----
output.Email = input.Email_Address;
output.FirstName = input.First_Name;
output.LastName = input.Last_Name;
----
+
The full code should look like this:
+
[source, code, linenums]
----
//MEL
//START -> DO NOT REMOVE
output.__id = input.__id;
//END -> DO NOT REMOVE
output.Department = input.Department;
output.Email = input.Email_Address;
output.FirstName = input.First_Name;
output.LastName = input.Last_Name;
----

. Save and run the project as a Mule Application.

....
------

== 示例代码

[NOTE]
要使此代码在Anypoint Studio中工作，您必须为Siebel和Salesforce帐户提供凭据。您可以使用代码中的值替换变量，也可以在`src/main/properties`文件夹中添加名为`mule.properties`的文件，以便为每个变量提供值。


[source, xml, linenums]
----
<mule xmlns:context="http://www.springframework.org/schema/context" xmlns:batch="http://www.mulesoft.org/schema/mule/batch" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:data-mapper="http://www.mulesoft.org/schema/mule/ee/data-mapper" xmlns:sfdc="http://www.mulesoft.org/schema/mule/sfdc" xmlns:siebel-io="http://www.mulesoft.org/schema/mule/siebel-io" xmlns:siebel="http://www.mulesoft.org/schema/mule/siebel" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
    xmlns:spring="http://www.springframework.org/schema/beans" version="EE-3.6.1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/siebel http://www.mulesoft.org/schema/mule/siebel/current/mule-siebel.xsd
http://www.mulesoft.org/schema/mule/siebel-io http://www.mulesoft.org/schema/mule/siebel-io/current/mule-siebel-io.xsd
http://www.mulesoft.org/schema/mule/sfdc http://www.mulesoft.org/schema/mule/sfdc/current/mule-sfdc.xsd
http://www.mulesoft.org/schema/mule/ee/data-mapper http://www.mulesoft.org/schema/mule/ee/data-mapper/current/mule-data-mapper.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/batch http://www.mulesoft.org/schema/mule/batch/current/mule-batch.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-current.xsd">
    <sfdc:config name="Salesforce" username="${salesforce.user}" password="${salesforce.password}" securityToken="${salesforce.securitytoken}" url="${salesforce.url}" doc:name="Salesforce">
        <sfdc:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
    </sfdc:config>
    <siebel:config name="Oracle_Siebel_Business_Object" user="${siebel.user}" password="${siebel.password}" server="${siebel.server}" serverName="${siebel.servername}" objectManager="${siebel.mgr}" dataSenseFilterQueryBusComp="[Name] = 'Action_IO' OR [Name] = 'Contact_IO'" dataSenseFilterQueryBusObjects="[Name] = 'Action_IO' OR [Name] = 'Contact_IO'" doc:name="oracle siebel business objects">
        <siebel:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
    </siebel:config>
    <data-mapper:config name="listcontact.contact_to_listcontact" transformationGraphPath="list&lt;contact.contact&gt;_to_list&lt;contact&gt;.grf" doc:name="listcontact.contact_to_listcontact"/>
    <context:property-placeholder location="mule.properties"/>
    <data-mapper:config name="listcontact.contact_to_listcontact_1" transformationGraphPath="list&lt;contact.contact&gt;_to_list&lt;contact&gt;_1.grf" doc:name="listcontact.contact_to_listcontact_1"/>
    <flow name="siebel2salesforce" doc:name="siebel2salesforce">
        <poll doc:name="Poll">
            <fixed-frequency-scheduler frequency="60000"/>
            <watermark variable="lastUpdate" default-expression="#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5).toString(&quot;MM/dd/yyyy HH:mm:ss&quot;)]" update-expression="#[new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5).toString(&quot;MM/dd/yyyy HH:mm:ss&quot;)]"/>
         <siebel:query-business-components config-ref="Oracle_Siebel_Business_Object" businessObjectComponentType="Contact.Contact"  doc:name="oracle siebel business objects" searchExpression="[Last Update - SDQ] &gt; '#[flowVars.lastUpdate]'">
                <siebel:fields-to-retrieve>
                    <siebel:fields-to-retrieve>Last Name</siebel:fields-to-retrieve>
                    <siebel:fields-to-retrieve>Email Address</siebel:fields-to-retrieve>
                    <siebel:fields-to-retrieve>First Name</siebel:fields-to-retrieve>
                    <siebel:fields-to-retrieve>Primary Organization</siebel:fields-to-retrieve>
                    <siebel:fields-to-retrieve>Personal Contact</siebel:fields-to-retrieve>
                    <siebel:fields-to-retrieve>Employee Number</siebel:fields-to-retrieve>
                    <siebel:fields-to-retrieve>Account Integration Id</siebel:fields-to-retrieve>
                </siebel:fields-to-retrieve>
            </siebel:query-business-components>
        </poll>
        <logger message="Polling from Siebel #[payload]" level="INFO" doc:name="Logger"/>
        <data-mapper:transform doc:name="List&lt;Contact.Contact&gt; To List&lt;Contact&gt;" config-ref="listcontact.contact_to_listcontact_1"/>
          
        <sfdc:create config-ref="Salesforce" type="Contact" doc:name="Salesforce">
            <sfdc:objects ref="#[payload]"/>
        </sfdc:create>
        <logger message="#[payload.toString()]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>
----

== 示例使用案例2

每隔一段时间轮询新注册管理机构的Salesforce连接器并将输出发送到Siebel。

[NOTE]
有关这些元素的深入信息，请参阅 link:/mule-user-guide/v/3.6/poll-reference[投票范围]， link:/anypoint-studio/v/5/datamapper-user-guide-and-reference[的DataMapper]和 link:/mule-user-guide/v/3.7/salesforce-connector[Salesforce连接器]中的文档。

[tabs]
------
[tab,title="Studio Visual Editor"]
....

image:example+use+case2.jpeg[example+use+case2] +

. Drag a *Poll Scope*  into a new flow:
+
image:poll2.jpeg[poll2] +
+
A link:/mule-user-guide/v/3.6/poll-reference[Poll Scope]  executes the Mule element placed inside it at regular intervals. In this case, it is a Salesforce connector.
. Configure the Poll Scope according to the settings below: +
image:pollnew.jpeg[pollnew]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Frequency* |60000
|*Start Delay* |0
|*Time Unit* |MILLISECONDS
|*Enable Watermark* |check
|*Variable Name* |lastUpdateSalesforce
|*Default Expression* |`#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID("PST8PDT")).minusSeconds(5))]`
|*Update Expression* |`#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID("PST8PDT")).minusSeconds(5))]`
|===
+
The poll scope now triggers once a minute. The watermark ensures that registries in the Salesforce aren't processed more than once. It does this by keeping track of  the last element processed in the last poll.
+
[NOTE]
To learn how watermarks work and what each attribute is for, read about link:/runtime-manager/managing-schedules[Poll Schedulers]

. Drag a *Salesforce Connector* into the space inside the Poll Scope.
+
image:poll3.jpeg[poll3]
+
The Salesforce connector is polled at the intervals you specify in the Poll Scope

. Open the *Properties* editor of the Salesforce connector and click the *+* sign to add a new Salesforce global element.
+
*{{0}}*

. On the Choose Global Type window, click ***Salesforce: Basic authentication***, and then click *Ok*.
+
image:sfbasicauth.jpeg[sfbasicauth]

. Configure the Salesforce global element properties:
+
image:Salesconfig.jpeg[Salesconfig]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Name* |Salesforce
|*User* |<Your user name>
|*Password* |<Your password>
|*Port* |<Port you're using>
|*URL* |<URL of your Salesforce repository>
|*Enable DataSense* |check
|===

. Click *Test Connection* to ensure that everything is correctly configured.

. Configure the Salesforce connector according to the settings below:
+
image:sf22.jpeg[sf22]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Display Name* |Salesforce
|*Coding Reference* |Salesforce
|*Operation* |Query
|*Language* |Native Query Language
|*Query Text* |`SELECT Id, email, firstname, lastname from Contact WHERE LastModifiedDate >#[flowVars.lastUpdateSalesforce]`
|===
+
*Note*: The search expression uses the same variable that is being updated by the Poll Scope. In this way, the Salesforce connector only returns the DB records that Mule hasn't processed in the last poll to avoid redundancies.

. Drag a *Logger* right after the Poll Scope, it registers the output of the Poll.
+
image:sftolog.jpeg[sftolog]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Message* |`From SFDC: #[payload]`
|*Level* |Info
|===
. Drag an *Oracle Siebel Integration Object* after the Logger. It uploads the output of the poll into your Siebel repository. +
image:logger+to+oracle.jpeg[logger+to+oracle]

. Open the *Properties* editor of the Siebel connector and click the *+* sign to add a new *Global Element*:
image:io21.jpeg[io21] +

. Configure the global element according to the settings below
+
image:globalprop1.jpeg[globalprop1]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Name* |Oracle_Siebel_Integration_Object
|*Username* |<Your user name>
|*Password* |<Your password>
|*Server* |<The server where you host Siebel>
|*Object Manager* |<The object manager you use>
|*Enable DataSense* |check
|*Default View Mode* |3
|*Data Sense Filter Query* |`[Name] = 'Action_IO' OR [Name] = 'Contact_IO'`
|===

. Click *Test Connection* to ensure that everything is correctly configured.

. Configure the Siebel connector as follows:
+
image:io22.jpeg[io22]
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Display Name* |Oracle Siebel Integration Object
|*Coding Reference* |Oracle_Siebel_Integration_Object
|*Operation* |Execute Siebel Adapter
|*Integration Object* |Contact IO
|*Method* |UPSERT
|*input-properties* |From Message:  `#[payload]`
|===

. Add a  *Data Mapper* element between the Logger and the Siebel connector. It maps fields from the data structure returned by Salesforce into the data structure required by Siebel.
+
image:flow+IO.jpeg[flow+IO]

. Configure the *Data Mapper* element:
+
Input:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Type* |Connector
|*Connector* |Salesforce
|*By Type* |check
|*List* |check
|*Object* |Contact
|===
+
Output:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Connector* |Oracle_Siebel_Integration_Object
|*Operation* |execute-siebel-adapter
|*Object* |Contact IO
|===
+
[TIP]
If DataSense works correctly, DataMapper should be able to populate all of the output fields on its own

. Click *Create mapping* for the DataMapper to build a mapping between both the data structures.
. A few fields don't have the same names in Salesforce and Siebel. You must configure them manually.
+
[%header%autowidth.spread]
|===
|Attribute |Value
|Email_Address |Email
|First_Name |FirstName
|Last_Name |LastName
|Person_UId |Id
|===
+
Also, Siebel requires two fields that don't exist in Salesforce. You must provide some default values for these. You can set the variables to use the following default values:
+
[%header%autowidth.spread]
|===
|Variable |Value
|Primary_Organization |Default Organization
|Personal_Contact |N
|===
+
There are two ways you can link these:

.. Look for the fields on both the columns in** DataLoader's graphical view**, then simply drag and drop one onto the other.
+
[TIP]
This is usually the easiest way to go, but given the number of fields to navigate, it may be hard to find the fields you need. Use the search box above the field list to find these quickly.

.. Enter *DataLoader's Script view* and paste the following lines of code below what is already written:
+
[source, code, linenums]
----
output.First_Name = input.FirstName;
output.Last_Name = input.LastName;
output.Email_Address = input.Email;
output.Person_UId = input.Id;
output.Primary_Organization = 'Default Organization';
output.Personal_Contact = 'N';
----
+
The full code should look like this: 
+
[source, code, linenums]
----
//MEL
//START -> DO NOT REMOVE
output.__id = input.__id;
output.__parent_id = input.__id;
//END -> DO NOT REMOVE
output.First_Name = input.FirstName;
output.Last_Name = input.LastName;
output.Email_Address = input.Email;
output.Person_UId = input.Id;
output.Primary_Organization = 'Default Organization';
output.Personal_Contact = 'N';
----

. Add another *Logger* at the end of the flow. It displays the outcome of the operation on the Console.
+
[%header,cols="2*"]
|===
a|
Attribute
a|
Value
|*Message* |`#[payload.toString()]`
|*Level* |Info
|===

. Save and run the project as a Mule Application.

....
[tab,title="XML Editor"]
....

. At the start of your project, add a Salesforce Global Element to set up global configuration attributes for this connector
+
[source, xml, linenums]
----
<sfdc:config name="Salesforce" username="${salesforce.user}" password="${salesforce.password}" securityToken="${salesforce.securitytoken}" url="${salesforce.url}" doc:name="Salesforce">
        <sfdc:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
    </sfdc:config>
----
+
[%header,cols="2*"]
|===
|Element |Description
a|
sfdc:config
|Configures connection settings for Salesforce
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`name` |Salesforce
a|`doc:name` |Salesforce
a|`url` |<URL where your Salesforce account is hosted>
a|`password` |<Your password>
a|`securityToken` |<Your security token>
a|`username` |<Your user name>
|===
+
[%header%autowidth.spread]
|===
|Child Element |Description
|`sfdc:connection-pooling-profile` |Configures connection pooling settings for connecting to Salesforce
|===
+
[%header%autowidth.spread]
|===
|Attribute |Value
|initialisationPolicy |INITIALISE_ONE
|exhaustedAction |WHEN_EXHAUSTED_GROW
|===

. Add a Siebel Global Element to set up global configuration attributes for this connector.
+
[source, xml, linenums]
----
<siebel:config name="Oracle_Siebel_Business_Object" user="${siebel.user}" password="${siebel.password}" server="${siebel.server}" serverName="${siebel.servername}" objectManager="${siebel.mgr}" dataSenseFilterQueryBusComp="[Name] = 'Action_IO' OR [Name] = 'Contact_IO'" dataSenseFilterQueryBusObjects="false" doc:name="oracle siebel business objects">
    <siebel:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
</siebel:config>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|siebel:config |Configures connection settings for Siebel
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`name` a|`Oracle_Siebel_Business_Object`
a|`user` |<Your username>
a|`password` |<Your password>
a|`server` |<The IP address of the Siebel server>
a|`serverName` |<The Siebel Enterprise server name>
a|`objectManager` |<The object manager you use>
a|`dataSenseFilterQueryBusComp` a|`[Name] = 'Action_IO' OR [Name] = 'Contact_IO'`
a|`dataSenseFilterQueryBusObjects` a|`false`
a|`doc:name` a|`oracle siebel business objects`
|===
+
[%header%autowidth.spread]
|===
|Child Element |Description
|`siebel:connection-pooling-profile` | Configures connection pooling settings for connecting to Siebel
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`initialisationPolicy` |INITIALISE_ONE
a|`exhaustedAction` |WHEN_EXHAUSTED_GROW
|===

. Build a new Flow:
+
[source, xml, linenums]
----
<flow name="salesforce2siebel" doc:name="salesforce2siebel" processingStrategy="synchronous">
    </flow>
----

. Add a *Poll Scope* inside your new Flow:
+
[source, xml, linenums]
----
<poll doc:name="Poll">
    <fixed-frequency-scheduler frequency="60000"/>
    <watermark variable="lastUpdateSalesforce" default-expression="#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5))]" update-expression="#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5))]"/>
</poll>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|Poll |A  link:/mule-user-guide/v/3.6/poll-reference[Poll Scope] executes the Mule element you place inside it at regular intervals. In this case, it is a Salesforce connector.
|===
+
[%header,cols="2*"]
|===
|Child Element |Description
a|`fixed-frequency-scheduler` |Sets the interval for polling
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|frequency |6000
|===
+
The poll scope now triggers once a minute. The watermark ensures that registries in the Salesforce aren't processed more than once. It does this by keeping track of the last element processed in the last poll.
+
[%header,cols="2*"]
|===
|Child Element |Description
a|`watermark` |The watermark ensures that registries in the Siebel DB aren't processed more than once by keeping track of the last element that was processed in the last poll.
|===
+
[NOTE]
To learn how watermarks work and what each attribute is for, read about  link:/runtime-manager/managing-schedules[Poll Schedulers].
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`variable` |lastUpdateSalesforce
|`default-expression` a|`#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5))]"`
|`update-expression` a|`#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5))]`
|===

. Inside this Poll Scope, add a *Salesforce Connector:*
+
[source, xml, linenums]
----
<sfdc:query config-ref="Salesforce" query="SELECT Id, email, firstname, lastname from Contact WHERE LastModifiedDate &gt;#[flowVars.lastUpdateSalesforce]" doc:name="Salesforce"/>
----
+
The Salesforce connector polls at the intervals you specify in the Poll Scope.
+
[%header,cols="2*"]
|===
|Element |Description
a|`sfdc:query` |Connects to Salesforce
|===
+
[%header,cols="2*"]
|===
|Attribute |Value
a|`config-ref` a|`Salesforce`
a|`query` a|`SELECT Id, email, firstname, lastname from Contact WHERE LastModifiedDate &gt;#[flowVars.lastUpdateSalesforce]`
a|`doc:name` a|`Salesforce`
|===

. After the Poll Scope, add a Logger to verify the output of this poll.
+
[source, xml, linenums]
----
<sfdc:query config-ref="Salesforce" query="SELECT Id, email, firstname, lastname from Contact WHERE LastModifiedDate &gt;#[flowVars.lastUpdateSalesforce]" doc:name="Salesforce"/>
----
+
[%header%autowidth.spread]
|===
|Element |Description
|`logger` |Logs messages to the Mule console
|===
+
[%header%autowidth.spread]
|===
|Attribute |Value
|Message |`From SFDC: #[payload]`
|Level |Info
|===
. Add a *Siebel connector* after this logger. It uploads the output of the poll into your Siebel repository.
+
[source, xml, linenums]
----
<siebel-io:execute-siebel-adapter config-ref="Oracle_Siebel_Integration_Object" integrationObject="Contact IO" method="UPSERT" doc:name="Oracle Siebel Integration Object">
            <siebel-io:input-properties ref="#[payload]"/>
        </siebel-io:execute-siebel-adapter>
----
+
[%header,cols="2*"]
|===
|Element |Description
a|`siebel-io:execute-siebel-adapter` |Creates a contact entry on the specified Siebel repository
|===
+
[%header,cols="2*"]
|===
|Attributes |Values
a|`config-ref` a|`Oracle_Siebel_Integration_Object`
a|`integrationObject` a|`Contact IO`
a|`method` |UPSERT
a|`doc:name` a|`Oracle Siebel Integration Object`
|===
+
[%header,cols="2*"]
|===
|Child Element |Description
a|`siebel-io:input-properties` |Defines what structure the created object has
|===
+
[%header,cols="2*"]
|===
|Attributes |Values
a|`ref` a|`#[payload]`
|===

. Add another logger after the Siebel connector to verify the success of the operation.
+
[source, xml, linenums]
----
<logger message="#[payload.toString()]" level="INFO" doc:name="Logger"/>
----
+
[%header%autowidth.spread]
|===
|Attribute |Value
|Message |`#[payload.toString()]`
|Level |Info
|===
. Add a *DataMapper* *component* between the first logger and the Siebel connector. It maps fields from the data structure returned by Salesforce into the data structure required by Siebel.
+
[source, xml, linenums]
----
<data-mapper:transform doc:name="DataMapper"/>
----

. Switch to the Studio Visual Editor to configure the *Data Mapper* element. Click *Data Mapper* to open its properties editor:
+
Input:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Type* |Connector
|*Connector* |Salesforce
|*By Type* |check
|*List* |check
|*Object* |Contact
|===
+
Output:
+
[%header%autowidth.spread]
|===
|Attribute |Value
|*Connector* |Oracle_Siebel_Integration_Object
|*Operation* |execute-siebel-adapter
|*Object* |Contact IO
|===
+
[TIP]
If DataSense works correctly, DataMapper should be able to populate all of the *output* fields on its own

. Click *Create mapping* for DataMapper to build a mapping between both data structures.
. A few fields don't have the same names in Salesforce as they do in Siebel. You need to configure these fields manually in DataMapper.
+
[%header%autowidth.spread]
|===
|Siebel Field |Salesforce Field
|Email_Address |Email
|First_Name |FirstName
|Last_Name |LastName
|Person_UId |Id
|===
+
Also, Siebel requires two fields that don't exist in Salesforce. You need to provide some default value for these. You can set the variables to use the following default values:
+
[%header,cols="2*"]
|===
a|
Variable
a|
Value
|Primary_Organization |Default Organization
|Personal_Contact |N
|===

. There are two ways you can link these:

.. Look for the fields on both columns in *DataLoader's graphical view* , then simply drag and drop one onto the other. 
+
[TIP]
This is usually the easiest way to go, but given the amount of fields to navigate, it may be hard to find the fields you need. Use the search box above the field list to find these quickly.

.. Enter  *DataLoader's Script view* and paste the following lines of code below what is already written:
+
[source, code, linenums]
----
output.First_Name = input.FirstName;
output.Last_Name = input.LastName;
output.Email_Address = input.Email;
output.Person_UId = input.Id;
output.Primary_Organization = 'Default Organization';
output.Personal_Contact = 'N';
----
+
The full code should look like this:
+
[source, code, linenums]
----
//MEL
//START -> DO NOT REMOVE
output.__id = input.__id;
output.__parent_id = input.__id;
//END -> DO NOT REMOVE
output.First_Name = input.FirstName;
output.Last_Name = input.LastName;
output.Email_Address = input.Email;
output.Person_UId = input.Id;
output.Primary_Organization = 'Default Organization';
output.Personal_Contact = 'N';
----

. Save and run the project as a Mule Application.

....
------

[NOTE]
要使此代码在Anypoint Studio中工作，您必须为Siebel和Salesforce帐户提供凭据。您可以使用代码中的值替换变量，也可以在`src/main/properties`文件夹中添加名为`mule.properties`的文件，以便为每个变量提供值。


[source, xml, linenums]
----
<mule xmlns:context="http://www.springframework.org/schema/context" xmlns:batch="http://www.mulesoft.org/schema/mule/batch" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:data-mapper="http://www.mulesoft.org/schema/mule/ee/data-mapper" xmlns:sfdc="http://www.mulesoft.org/schema/mule/sfdc" xmlns:siebel-io="http://www.mulesoft.org/schema/mule/siebel-io" 
xmlns:siebel="http://www.mulesoft.org/schema/mule/siebel" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
xmlns:spring="http://www.springframework.org/schema/beans" version="EE-3.6.1"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/siebel http://www.mulesoft.org/schema/mule/siebel/current/mule-siebel.xsd
http://www.mulesoft.org/schema/mule/siebel-io http://www.mulesoft.org/schema/mule/siebel-io/current/mule-siebel-io.xsd
http://www.mulesoft.org/schema/mule/sfdc http://www.mulesoft.org/schema/mule/sfdc/current/mule-sfdc.xsd
http://www.mulesoft.org/schema/mule/ee/data-mapper http://www.mulesoft.org/schema/mule/ee/data-mapper/current/mule-data-mapper.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/batch http://www.mulesoft.org/schema/mule/batch/current/mule-batch.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-current.xsd">
<siebel:config name="Oracle_Siebel_Business_Object" user="${siebel.user}" password="${siebel.password}" server="${siebel.server}" serverName="${siebel.servername}" objectManager="${siebel.mgr}" dataSenseFilterQueryBusComp="[Name] = 'Contact'" dataSenseFilterQueryBusObjects="[Name] = 'Contact'" doc:name="oracle siebel business objects">
<siebel:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
    </siebel:config>
    <sfdc:config name="Salesforce" username="${salesforce.user}" password="${salesforce.password}" securityToken="${salesforce.securitytoken}" url="${salesforce.url}" doc:name="Salesforce">
        <sfdc:connection-pooling-profile initialisationPolicy="INITIALISE_ONE" exhaustedAction="WHEN_EXHAUSTED_GROW"/>
    </sfdc:config>
    <data-mapper:config name="listcontact_to_contact_io" transformationGraphPath="listcontact_to_contact_io.grf" doc:name="listcontact_to_contact_io"/>
    <flow name="Poll_Salesforce_2_Siebel" doc:name="Poll_Salesforce_2_Siebel" processingStrategy="synchronous">
        <poll doc:name="Poll">
            <fixed-frequency-scheduler frequency="60000"/>
            <watermark variable="lastUpdateSalesforce" default-expression="#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5))]" update-expression="#[org.joda.time.format.ISODateTimeFormat.dateTime().print(new org.joda.time.DateTime().withZone(org.joda.time.DateTimeZone.forID(&quot;PST8PDT&quot;)).minusSeconds(5))]"/>
            <sfdc:query config-ref="Salesforce" query="SELECT Id, email, firstname, lastname from Contact WHERE LastModifiedDate &gt;#[flowVars.lastUpdateSalesforce]" doc:name="Salesforce"/>
        </poll>
        <logger message="From SFDC: #[payload]" level="INFO" doc:name="Logger"/>
        <data-mapper:transform config-ref="listcontact_to_contact_io" doc:name="List&lt;Contact&gt; To Contact IO"/>
        <siebel-io:execute-siebel-adapter config-ref="Oracle_Siebel_Integration_Object" integrationObject="Contact IO" method="UPSERT" doc:name="Oracle Siebel Integration Object">
            <siebel-io:input-properties ref="#[payload]"/>
        </siebel-io:execute-siebel-adapter>
         <logger message="Updated in Siebel: #[payload]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>
----


== 另请参阅

* 了解 link:/anypoint-studio/v/5/datamapper-user-guide-and-reference[的DataMapper]转换器，这是将映射分配给数据的最有效方式。
* 阅读有关 http://www.mulesoft.org/connectors/siebel-connector[Siebel连接器]的高级信息。
* 详细了解 link:/mule-user-guide/v/3.7/anypoint-connectors[Anypoint连接器]。
