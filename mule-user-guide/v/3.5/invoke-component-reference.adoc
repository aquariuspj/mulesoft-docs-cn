= 调用组件引用

*invoke component*调用Spring bean中定义的对象的指定方法。您可以提供一个参数表达式的数组来将消息映射到方法参数。 Mule通过方法名称确定使用哪种方法，以及提供的参数表达式的数量。在可能的情况下，Mule自动转换参数表达式的结果以匹配方法参数类型。请注意，Mule不支持具有相同名称和相同数量参数的多个方法。

== 配置调用组件

当您想要在处理消息时使用定制Java代码中定义的现有方法时，请使用invoke组件。配置调用消息处理器涉及两个步骤：

. 将包含该方法的对象包含在应用程序的`src/main/java`目录中。

. 配置调用消息处理器以引用该对象中的方法。

[tabs]
------
[tab,title="Studio Visual Editor"]
....
image:invoke-pe-blank.png[invoke-pe-blank]

[%header%autowidth.spread]
|===
|Field |Description |Required? |Example XML
|*Display Name* |Customize to display a unique name for the component in your application. | |`doc:name="Invoke"`
|*Name* |The name of the message processor for logging purposes. | |`name:"someName"`
|*Object Ref* |Reference to the object containing the method to be invoked. ^|X |`object-ref="beanName"`
|*Method* |The name of the method to be invoked. ^|X |`method="addTwoNumbers"`
|*Method Arguments* |Comma-seperated list of Mule expressions that, when evaluated, are the arguments for the method invocation. | |`methodArguments="#[1], #[2]"`
|*Method Argument Types* |Comma-seperated list of argument types for the method invocation. Use when you have more than one method with the same name in your class. | |`methodArgumentTypes="java.lang.Float,java.lang.Float"`
|===
....
[tab,title="XML Editor or Standalone"]
....
Include the invoke method in your flow, and define a Spring bean as a global element with the reference to the object containing the method.

[%header%autowidth.spread]
|===
|Element |Description
|*invoke* |Invokes a method in a specified object using method arguments determined by Mule expressions.
|===

[%header%autowidth.spread]
|===
|Attribute |Description |Required?
|*doc:name* |Customize to display a unique name for the component in your application. Not required for Mule Standalone. |
|*name* |The name of the message processor for logging purposes. |
|*object-ref* |Reference to the object containing the method to be invoked. ^|X
|*method* |The name of the method to be invoked. ^|X
|*methodArguments* |Comma-seperated list of Mule expressions that, when evaluated, are the arguments for the method invocation. |
|*methodArgumentTypes* |Comma-separated list of argument types for the method invocation. Use when you have more than one method with the same name in your class. |
|===

[source, xml, linenums]
----
<spring:beans>
        <spring:bean name="beanName" class="org.mule.example.ClassName"/>
    </spring:beans>
 
    <flow 
 
...
        <invoke object-ref="beanName" method="addTwoNumbers" methodArguments="#[1], #[2]" methodArgumentTypes="java.lang.Float, java.lang.Float" name="someName" doc:name="Invoke"/>
 
...
 
    </flow>
----
....
------

== 示例

在这个例子中，"Hello World"流程使用一个invoke组件来实现被引用类中的特定方法。所引用的Java类在下面提供，并且必须包含在应用程序的`src/main/java`目录中。

点击浏览器中的http：// localhost：8081 / greeting？name = Bob返回"Hello Bob!"

[source, java, linenums]
----
package org.mule.example;
public class GreetingService {
    public String sayHello(String name) {
        return String.format("Hello %s!", name);
    }
     
    public String sayGoodbye(String name) {
        return String.format("Goodbye %s!", name);
    }
     
}
----

[tabs]
------
[tab,title="Studio Visual Editor"]
....
Create a simple flow using HTTP connector and an invoke component.

image:invokeflow.png[invokeflow]

Configure the invoke component to reference the Java class.

image:invoke-pe.png[invoke-pe]

Ensure the Java class is included in your project structure.

image:invokejava.png[invokejava]
....
[tab,title="XML Editor or Standalone"]
....
[source, xml, linenums]
----
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
    xmlns:spring="http://www.springframework.org/schema/beans" version="EE-3.5.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <spring:beans>
        <spring:bean name="greetingService" class="org.mule.example.GreetingService"/>
    </spring:beans>
    <flow name="greetingFlow" doc:name="greetingFlow">
        <http:inbound-endpoint exchange-pattern="request-response" host="localhost" port="8081" path="greeting" doc:name="HTTP"/>
        <invoke object-ref="greetingService" method="sayHello" methodArguments="#[message.inboundProperties.'http.query.params'.name]" doc:name="Invoke"/>
    </flow>
</mule>
----
....
------

== 另请参阅

* 详细了解Mule中可用的[其他组件]。
