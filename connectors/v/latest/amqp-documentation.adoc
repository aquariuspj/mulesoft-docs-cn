=  AMQP连接器文档参考

+++
AmqpConnector是符合AMQP 0.9.1的MuleSoft扩展，用于消费和生成AMQP消息。该扩展支持AMQP功能，包括交换和队列，消费者，确认模式和本地事务。
+++


== 配置
---
[[config]]
=== 配置

+++
AmqpConnector的基本配置
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 名称 | 字符串 | 此配置的名称。连接器使用该名称引用配置。 |  |  *x* {nbsp}
| 对| 字符串进行编码 |   +++如果邮件无法通信，则使用邮件正文的默认编码+++  |   |  { NBSP}
| 内容类型a | 字符串 |   +++消息不传递时使用的消息正文的默认contentType +++  |   +++ {{ 0}} {+++ {5}} {} NBSP
| 创建备用队列 | 字符串 |  +++是否根据后备定义创建不存在的队列，以备定义。+++  |   ++ +真+++  |  {} NBSP
| 创建备用Exchange  | 字符串 |  +++是否根据后备定义创建非现有交换，以防定义。+++  |   ++ +真+++  |  {} NBSP
|======================

+++
连接配置
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 主持人 | 字符串 | 代理商的主持人连接到。 |  |  *x* {n}
| 端口 |  Number  |   +++要连接的AMQP代理端口。+++  |   5672用于非安全连接/ 5671用于安全连接{ 4}} {} NBSP
| 用户名| 字符串 |   +++在提供认证凭证时使用的用户名。+++  |    |  {{0} } {} NBSP
| 密码| 字符串 |   +++提供身份验证凭据时使用的密码+++  |    |  {{0} } {} NBSP
|  useTls  | 布尔值 |  +++是否需要使用TLS。如果未提供，则将使用AMQP连接的默认值。+++  |   +++ false +++  |  {nbsp}
|======================

+++
消费者配置
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 确认模式a | 枚举，其中之一：

**  IMMEDIATE
**  AUTO
**  MANUAL
  |   +++消费消息时使用的ConsumerAckMode可以在消息源级别覆盖。 +++  |   +++ +++ AUTO  |  {} NBSP
  | 否本地 | 布尔值 | 如果设置为true，则服务器不会向发布它们的连接发送消息。 | false {{5 }} {} NBSP
  | 独占用户 | 布尔值 | 如果连接器只应创建独占使用者，则设置为true，即只有创建的使用者才能访问队列。 | 假 |  {} NBSP
  | 消费者数量 | 整数 | 消息源产生的消费者数量，用于接收AMQP消息。每位消费者都将创建一个频道。 |  4  |  {nbsp}
|======================

+++
发布者配置
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 交付模式模式a | 枚举，其中之一：

**  PERSISTENT
** 暂态
  |  +++发布到AMQP代理时使用的传递模式+++  |   +++ PERSISTENT +++  |  {nbsp}
  | 优先级 | 整数 | 发布到AMQP代理时使用的优​​先级。 |   |  {n}
  | 请求代理确认 | 布尔值 | 是否在未提供确认的情况下失败。 |  false  |  {
  | 强制 | 布尔 | 如果消息无法路由到队列，操作是否失败。 |  false  |  {nbsp }
  | 立即 | 布尔值 | 如果无法立即将消息路由到队列使用者，操作是否失败。 |  false  |  {NBSP}
  | 返回的邮件交换 | 字符串 | 发布返回的邮件。 |   |  {n}
 
|======================

+++
服务质量配置
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 预取大小 | 整数 | 该字段定义预取大小窗口。代理将发送尽可能多的消息，而不会超出prefetchSize窗口的八位字节（字节）。 0用于没有特定的限制。 |  0  |  {nbsp}
| 预取计数 | 整数 | 根据整个消息指定全局预取窗口。该字段可以与预取大小字段结合使用;只有当预取窗口允许时才会提前发送消息。 0用于没有特定的限制。 |  0  |  {nbsp}
|======================

==== 相关操作
*  <<consume>> {nbsp}
*  <<publish>> {nbsp}
*  <<publishConsume>> {nbsp}
*  <<ack>> {nbsp}
*  <<reject>> {nbsp}

==== 相关资源
*  <<listener>> {nbsp}


== 操作

[[consume]]
=== 消费
`<amqp:consume>`

+++
允许用户使用给定队列中的单个AmqpMessage的操作。
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置的名称。 |  |  *x* {n}
| 队列名称a | 字符串 |   +++应从中消费消息的队列的名称+++  |   |  *x* { NBSP}
| 内容类型a | 字符串 |   +++消息的内容内容类型+++  |   |  {nbsp}
| 对| 字符串进行编码 |   +++邮件的内容编码+++  |   |  {n}
| 备用队列定义| 队列的定义 |   +++队列定义用于队列声明，以防队列中没有queueName +++  |   {{4 }} {} NBSP
| 确认模式a | 枚举，其中之一：

**  IMMEDIATE
** 手动 |   +++将通过消息和会话+++  |   | 配置的ConsumerAckMode，
| 最多等待| 数量 |   +++超时前等待消息的最大时间+++  |   +++ 10000 +++  |  { NBSP}
| 最大等待单元a | 枚举，其中之一：

** 纳秒
**  MICROSECONDS
**  MILLISECONDS
** 秒后
**  MINUTES
**  HOURS
**  DAYS  |   +++用于maximumWaitTime配置的时间单位+++  |   +++ MILLISECONDS +++  |  {nbsp}
| 交易行为a | 枚举，其中之一：

**  ALWAYS_JOIN
**  JOIN_IF_POSSIBLE
**  NOT_SUPPORTED  |   +++操作可以对事务进行的加入操作的类型。+++  |   +++ JOIN_IF_POSSIBLE +++  |  {nbsp}
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  |   +++连接错误情况下的重试策略+++  |   |  {nbsp}
|======================

==== 输出
[cols=".^50%,.^50%"]
|======================
|  *Type* a | 任何
|  *Attributes Type* a |  <<AmqpAttributes>>
|======================

==== 用于配置。
*  <<config>> {nbsp}

==== 抛出
*  AMQP：TIMEOUT {
*  AMQP：连接性{nbsp}
*  AMQP：消费{
*  AMQP：RETRY_EXHAUSTED {nbsp}
*  AMQP：QUEUE_NOT_FOUND {nbsp}
*  AMQP：CREATION_NOT_ALLOWED {nbsp}


[[publish]]
=== 发布
`<amqp:publish>`

+++
允许用户将一个AmqpMessage发布到给定交易所的操作
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置的名称。 |  |  *x* {n}
| 交换名称| 字符串 |   +++发布消息到+++的交易所的名称 |   |  *x* {nbsp}
| 备用交换定义| 交换的定义 |   +++交换名称+++  |   {{4} } {} NBSP
| 路由密钥|  LIST  |   +++路由密钥列表+++  |   |  {n}
| 交付模式a | 枚举，其中之一：

**  PERSISTENT
** 暂态
  |  +++发布到AMQP代理时使用的传递模式+++  |   +++ PERSISTENT +++  |  {nbsp}
| 相关性ID a | 字符串 |   +++消息+++  |   | 的AMQPCorrelationID标头{
|  ContentType a | 字符串 |   +++正文的内容类型+++  |   |  {nbsp}
| 对| 字符串进行编码 |   +++消息正文的outboundEncoding +++  |   |  {n}
| 回复| 字符串 |   +++ AMQP replyTo此消息应被回复到的队列的属性信息+++  |   |  {n}
| 用户属性a | 对象 |   +++应为此消息设置的自定义用户属性。每个属性都与其他默认AMQP用户属性合并。所有AMQP用户属性都在一个对象中一次性设置。您可以将此对象编写为DataWeave对象，例如`#[output application/json --- { userName: vars.user, appName: 'myApp'}]`。然后将用户属性对象中的每个键/值设置为单独的AMQP用户属性。 +++  |   |  {} NBSP
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  |   +++连接错误情况下的重试策略+++  |   |  {nbsp}
|======================


==== 用于配置。
*  <<config>> {nbsp}

==== 抛出
*  AMQP：发布{n}
*  AMQP：UNROUTABLE_MESSAGE {n}
*  AMQP：CREATION_NOT_ALLOWED {nbsp}
*  AMQP：ILLEGAL_BODY {nbsp}
*  AMQP：RETRY_EXHAUSTED {nbsp}


[[publishConsume]]
=== 发布消费
`<amqp:publish-consume>`

+++
允许用户向AMQP Exchange发送消息并等待提供的replyTo目标或动态创建的临时目标的响应的操作
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置名称。 |  |  {n}
| 交换名称 |  字符串 |  +++将消息发布到+++的交换名称 |    |  *x* { NBSP}
| 关联ID a | 字符串 |   +++消息+++  |   | 的AMQPCorrelationID标头{
|  ContentType a | 字符串 |   +++正文的内容类型+++  |  +++ */* +++  |  {nbsp }
| 编码| 字符串 |   +++消息正文的出站编码+++  |   |  {n}
| 用户属性a | 对象 |   +++应为此消息设置的自定义用户属性。每个属性都与其他默认AMQP用户属性合并。所有AMQP用户属性都在一个对象中一次性设置。您可以将此对象编写为DataWeave对象，例如`#[output application/json --- { userName: vars.user, appName: 'myApp'}]`。然后将用户属性对象中的每个键/值设置为单独的AMQP用户属性。 +++  |   |  {} NBSP
| 最多等待| 数量 |   +++超时前等待消息的最大时间+++  |   +++ 10000 +++  |  { NBSP}
| 最大等待单元a | 枚举，其中之一：

** 纳秒
**  MICROSECONDS
**  MILLISECONDS
** 秒后
**  MINUTES
**  HOURS
**  DAYS  |   +++用于maximumWaitTime配置的时间单位+++  |   +++ MILLISECONDS +++  |  {nbsp}
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  |   +++连接错误情况下的重试策略+++  |   |  {nbsp}
|======================

==== 输出
[cols=".^50%,.^50%"]
|======================
|  *Type* a | 任何
|  *Attributes Type* a |  <<AMQPAttributes>>
|======================

==== 用于配置。
*  <<config>> {nbsp}

==== 抛出
*  AMQP：PUBLISHING_CONSUMING {n}
*  AMQP：发布{n}
*  AMQP：TIMEOUT {
*  AMQP：连接性{nbsp}
*  AMQP：消费{
*  AMQP：ILLEGAL_BODY {nbsp}
*  AMQP：RETRY_EXHAUSTED {nbsp}
*  AMQP：QUEUE_NOT_FOUND {nbsp}
*  AMQP：CREATION_NOT_ALLOWED {nbsp}


[[ack]]
=== 的Ack
`<amqp:ack>`

+++
允许用户确认已交付的AmqpMessage的操作。
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 确认ID a | 字符串 |   +++消息的ACK消息到ACK +++  |   |  *x* {nbsp}
|======================

[[reject]]
=== 拒绝
`<amqp:reject>`

+++
允许用户拒绝交付的AmqpMessage的操作。
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 确认ID a | 字符串 |   +++消息的ACK消息到ACK +++  |   |  *x* {nbsp}
| 重新排列| 布尔值 |   +++指示是否必须重新排列被拒绝的消息+++  |  false  |  {n}
|======================

== 来源

[[listener]]
=== 监听器
`<amqp:listener>`

+++
AMQP队列监听器允许监听传入的消息。
+++

==== 监听器配置参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置的名称。 |  |  *x* {n}
| 队列名称a | 字符串 |   +++要使用的队列名称+++  |   |  *x* {
| 消费者数量a | 数量 |   +++将用于接收AMQP消息的并发使用者数量+++  |   +++ 4 +++ {{ 4}} {} NBSP
| 消费者标记| 字符串 |   +++客户端生成的消费者标记来建立上下文。+++  |   +++ 4 +++ {{4 }} {} NBSP
| 恢复策略a | 枚举，其中之一：

**  NONE
**  NO_REQUEUE
**  REQUEUE  | 执行频道恢复或回滚时使用的策略。|  REQUEUE  |  {n}
| 入站内容键入一个| 字符串 |   +++消息正文的内容类型+++  |   |  {n}
| 入站编码| 字符串 |   +++消息正文的inboundEncoding +++  |   |  {nbsp}
|======================

== 类型
[[RedeliveryPolicy]]
=== 重新送货政策

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 最大重新送货次数|  Number  | 在触发流程失败消息 |   | 
之前，可以重新传递和处理消息的最大次数
| 使用安全哈希a | 布尔值 | 是否使用安全哈希算法来识别重新发送的邮件 |   | 
| 消息摘要算法a | 字符串 | 要使用的安全哈希算法。如果未设置，则默认值为SHA-256。 |   | 
|  ID表达式a | 字符串 | 定义一个或多个表达式用于确定消息何时被重新传递。如果useSecureHash为false，则只能设置此属性。 |   | 
| 对象存储区|  <<ObjectStore>>  | 将存储每个消息的重新传送计数器的对象存储区。 |   | 
|======================

[[reconnect]]
=== 重新连接

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 频率a | 数字 | 重新连接 |   | 
的频率（以毫秒为单位）
| 计算| 数字 | 进行多少次重新连接尝试 |   | 
|======================

[[reconnect-forever]]
=== 重新连接Forever

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 频率a | 数字 | 重新连接 |   | 
的频率（以毫秒为单位）
|======================

[[queue-definition]]
== 队列定义

=== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 删除策略| 枚举，其中之一：

** 显
**  SHUTDOWN
**  UNUSED
  | 定义声明的队列何时必须从代理中移除。 | 显式 |  {n}
将 |   |  {
|======================

[[exchange-definition]]
==  Exchange定义

=== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 删除策略| 枚举，其中之一：

** 显
**  SHUTDOWN
**  UNUSED
  | 定义何时必须从代理中删除已声明的交易所。| 显示 |  {n}
|  Exchange键入| 枚举，其中的一个：

**  DIRECT
**  TOPIC
**  FANOUT
**  HEADERS
  |要宣布的交易所类型|  FANOUT  |  {n}
|======================

[[AmqpAttributes]]
==  Amqp属性

=== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 封套 | 封装 | 封装一组用于AMQP基本方法的参数 |   |
| 属性 | 属性 |  AMQP消息属性 |   |  
| 标题 |  MAP  |  AMQP消息标题 |   | 
|======================

[[Envelope]]
== 信封

=== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 交付标记 | 号码 | 交付标记 |   |
|  Redeliver  | 布尔 | 如果这是失败确认后的重新投递，则返回true |   |
|  Exchange  | 字符串 | 用于当前操作的交换。|   |
| 路由关键字 | 字符串 | 路由键关联的路由关键字|   |
|======================

[[Properties]]
== 属性

=== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 内容类型 | 字符串 | 消息的内容类型。 |   |
| 内容编码 | 字符串 | 邮件的内容编码。 |   |
| 交付模式 | 交付模式 | 发布到AMQP代理时使用的交付模式。 |   |
| 优先级 |  Number  | 发布到AMQP代理时使用的优​​先级。 |   |
| 相关性ID  | 字符串 | 用于实施RPC模式以区分请求回复中的消息。 |   |
|  replyTo  | 字符串 |  RPC中的目的地集。 |   |
| 到期 | 字符串 | 消息的过期时间（以毫秒为单位）。 |   |
|  messageId  | 字符串 | 消息 |   |
的消息ID
| 时间戳 |  TIMESTAMP  | 所用消息的时间戳 |   |
| 类型 | 字符串 | 所用消息的类型 |   |
|  userId  | 字符串 | 邮件的用户标识 |   |		
|  appId  | 字符串 | 消息的应用ID  |   |
|  clusterId  | 字符串 | 消息的群集标识 |   |		
|======================





