：toc：离开
：toc-title：VM连接器
：toclevels：2
：最后更新标签!:
：文档信息：
：source-highlighter：coderay
：图标：字体


=  VM连接器文档参考

+++
VM连接器用于intra / inter应用程序通信。通信是通过异步队列完成的，可以是暂时的或持久的。瞬时队列更快，但在系统崩溃的情况下不可靠。另一方面，持续的队列较慢但可靠。在单个实例上运行时，持久队列通过序列化并将内容存储到磁盘中工作。在集群模式下运行时，持久队列由内存网格支持。这意味着，当流使用VM连接器将内容发布到队列时，运行时将决定是在相同的源节点中处理该消息，还是将其发送到群集以供其他节点进行拾取。这是一种在集群中分布负载的简单方法。无论如何，交易总是受支持的。每个配置定义它自己的一组队列。这些队列仅对引用该配置的组件可见。
+++


== 配置
---
[[config]]
=== 配置

+++
默认配置
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
|名称 | 字符串 | 此配置的名称。连接器使用该名称引用配置。 |  |  *x* {nbsp}
| 连接|  <<config_connection, Connection>>
  | 可以提供给此配置的连接类型。 |  |  *x* {nbsp}
| 队列<<queue>>  |  的| 数组+++此配置拥有的队列+++  |   |  *x* {nbsp }
|======================

==== 连接类型
[[config_connection]]
===== 连接

+++
返回VMConnection的实例
+++

====== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 重新连接a |  <<Reconnection>>  |   +++部署应用程序时，将在所有连接器上执行连接测试。如果设置为true，如果在耗尽关联的重新连接策略后未通过测试，则部署将失败+++  |   |  {nbsp}
|======================

==== 相关操作
*  <<consume>> {nbsp}
*  <<publish>> {nbsp}
*  <<publishConsume>> {nbsp}

==== 相关资源
*  <<listener>> {nbsp}


== 操作

[[consume]]
=== 消费
`<vm:consume>`

+++
从队列中拖出一条消息。如果消息不是立即可用的，它将等待配置的queueTimeout，之后会抛出VM：QUEUE_TIMEOUT错误。 <p>发布内容的队列必须是<vm:listener> <b>不存在</b>的队列。从<vm:listener>存在的队列中消耗是不允许的。
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置的名称。 |  |  *x* {n}
| 交易行为a | 枚举，其中之一：

**  ALWAYS_JOIN
**  JOIN_IF_POSSIBLE
**  NOT_SUPPORTED  |   +++操作可以对事务进行的加入操作的类型。+++  |   +++ JOIN_IF_POSSIBLE +++  |  {nbsp}
| 队列名称a | 字符串 |   +++队列名称+++  |   |  *x* {nbsp}
| 超时a | 数字 |   +++在发生超时错误失败之前，等待队列完成和操作（发布或使用）的时间为+++  |   + ++ 5 +++  |  {} NBSP
| 超时单元a | 枚举，其中之一：

** 纳秒
**  MICROSECONDS
**  MILLISECONDS
** 秒后
**  MINUTES
**  HOURS
**  DAYS  |   +++符合#timeoutUnit +++  |   +++ SECONDS +++  | 的时间单位
| 目标变量a | 字符串 |   +++操作输出将放置在其上的变量名称+++  |   |  {nbsp}
| 目标值a | 字符串 |   +++将针对操作输出评估的表达式，并将该表达式的结果存储在目标变量+++  |  中+++＃[有效载荷] +++  |  {} NBSP
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  |   +++连接错误情况下的重试策略+++  |   |  {nbsp}
|======================

==== 输出
[cols=".^50%,.^50%"]
|======================
|  *Type* a | 任何
|  *Attributes Type* a |  <<VMMessageAttributes>>
|======================

==== 用于配置。
*  <<config>> {nbsp}

==== 抛出
*  VM：EMPTY_QUEUE {n}
*  VM：RETRY_EXHAUSTED {nbsp}
*  VM：CONNECTIVITY {n}


[[publish]]
=== 发布
`<vm:publish>`

+++
将给定内容发布到给定queueName的队列中。
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置的名称。 |  |  *x* {n}
| 内容a | 任何 |   +++要发布的内容+++  |   +++＃[有效负载] +++  |  {nbsp}
| 交易行为a | 枚举，其中之一：

**  ALWAYS_JOIN
**  JOIN_IF_POSSIBLE
**  NOT_SUPPORTED  |   +++操作可以对事务进行的加入操作的类型。+++  |   +++ JOIN_IF_POSSIBLE +++  |  {nbsp}
| 队列名称a | 字符串 |   +++队列名称+++  |   |  *x* {nbsp}
| 超时a | 数字 |   +++在发生超时错误失败之前，等待队列完成和操作（发布或使用）的时间为+++  |   + ++ 5 +++  |  {} NBSP
| 超时单元a | 枚举，其中之一：

** 纳秒
**  MICROSECONDS
**  MILLISECONDS
** 秒后
**  MINUTES
**  HOURS
**  DAYS  |   +++符合#timeoutUnit +++  |   +++ SECONDS +++  | 的时间单位
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  |   +++连接错误情况下的重试策略+++  |   |  {nbsp}
|======================


==== 用于配置。
*  <<config>> {nbsp}

==== 抛出
*  VM：RETRY_EXHAUSTED {nbsp}
*  VM：QUEUE_TIMEOUT {nbsp}
*  VM：CONNECTIVITY {n}


[[publishConsume]]
=== 发布消费
`<vm:publish-consume>`

+++
将给定内容发布到队列中，然后等待队列超时，以便在该操作自动创建的临时答复队列上提供响应。 <p>临时应答队列在收到响应或超时后自动处理。 <p>发布内容的队列必须是<vm:listener> <b>不存在<b>的队列。从不存在<vm:listener>的队列中消费。
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置的名称。 |  |  *x* {n}
| 内容a | 任何 |   +++要发布的内容+++  |   +++＃[有效负载] +++  |  {nbsp}
| 交易行为a | 枚举，其中之一：

**  ALWAYS_JOIN
**  JOIN_IF_POSSIBLE
**  NOT_SUPPORTED  |   +++操作可以对事务进行的加入操作的类型。+++  |   +++ JOIN_IF_POSSIBLE +++  |  {nbsp}
| 队列名称a | 字符串 |   +++队列名称+++  |   |  *x* {nbsp}
| 超时a | 数字 |   +++在发生超时错误失败之前，等待队列完成和操作（发布或使用）的时间为+++  |   + ++ 5 +++  |  {} NBSP
| 超时单元a | 枚举，其中之一：

** 纳秒
**  MICROSECONDS
**  MILLISECONDS
** 秒后
**  MINUTES
**  HOURS
**  DAYS  |   +++符合#timeoutUnit +++  |   +++ SECONDS +++  | 的时间单位
| 目标变量a | 字符串 |   +++操作输出将放置在其上的变量名称+++  |   |  {nbsp}
| 目标值a | 字符串 |   +++将针对操作输出评估的表达式，并将该表达式的结果存储在目标变量+++  |  中+++＃[有效载荷] +++  |  {} NBSP
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  |   +++连接错误情况下的重试策略+++  |   |  {nbsp}
|======================

==== 输出
[cols=".^50%,.^50%"]
|======================
|  *Type* a | 任何
|  *Attributes Type* a |  <<VMMessageAttributes>>
|======================

==== 用于配置。
*  <<config>> {nbsp}

==== 抛出
*  VM：RETRY_EXHAUSTED {nbsp}
*  VM：QUEUE_TIMEOUT {nbsp}
*  VM：CONNECTIVITY {n}


== 来源

[[listener]]
=== 监听器
`<vm:listener>`

+++
在VM队列上创建并侦听的源。 <p>虚拟机队列是通过在其上放置监听器来创建的，这就是为什么这个监听器包含队列行为的参数，比如持久与否，最大容量等。
+++

==== 参数
[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|======================
| 姓名 | 类型 | 描述 | 默认值 | 必需
| 配置 | 字符串 | 要使用的配置的名称。 |  |  *x* {n}
| 消费者数量| 数量 |   +++要放置在队列中的并发使用者数量。随着消费者数量的增加，该消息来源将消息推送到拥有流程中的速度也会增加。+++  |   +++ 4 +++  |  {nbsp}
| 交易行为a | 枚举，其中之一：

**  ALWAYS_BEGIN
** 无 |   +++源对交易可采取的开始操作类型+++  |   +++无+++  |  {nbsp}
| 交易键入一个| 枚举，其中一个：

**  LOCAL
**  XA  |   +++要创建的事务的类型。可用性取决于运行时版本。+++  |   +++ LOCAL +++  |  {nbsp}
| 重新投放政策a |  <<RedeliveryPolicy>>  |   +++定义处理同一邮件的重新投递的政策+++  |   |  {n}
| 队列名称a | 字符串 |   +++队列名称+++  |   |  *x* {nbsp}
| 超时a | 数字 |   +++在发生超时错误失败之前，等待队列完成和操作（发布或使用）的时间为+++  |   + ++ 5 +++  |  {} NBSP
| 超时单元a | 枚举，其中之一：

** 纳秒
**  MICROSECONDS
**  MILLISECONDS
** 秒后
**  MINUTES
**  HOURS
**  DAYS  |   +++符合#timeoutUnit +++  |   +++ SECONDS +++  | 的时间单位
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  |   +++连接错误情况下的重试策略+++  |   |  {nbsp}
| 内容a | 任何 |   |   +++＃[有效负载] +++  |  {nbsp}
|======================

==== 输出
[cols=".^50%,.^50%"]
|======================
|  *Type* a | 任何
|  *Attributes Type* a |  <<VMMessageAttributes>>
|======================

==== 用于配置。
*  <<config>> {nbsp}



== 类型
[[Reconnection]]
=== 重新连接

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 部署失败| 布尔值 | 部署应用程序时，将在所有连接器上执行连接测试。如果设置为true，则在耗尽关联的重新连接策略后，如果测试未通过，则部署将失败 |   | 
| 重新连接策略a |  * <<reconnect>>
*  <<reconnect-forever>>  | 重新连接策略使用 |   | 
|======================

[[reconnect]]
=== 重新连接

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 频率a | 数字 | 重新连接 |   | 
的频率（以毫秒为单位）
| 计算| 数字 | 进行多少次重新连接尝试 |   | 
|======================

[[reconnect-forever]]
=== 重新连接Forever

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 频率a | 数字 | 重新连接 |   | 
的频率（以毫秒为单位）
|======================

[[queue]]
=== 队列

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 队列名称| 字符串 |   |   |  x
| 队列键入| 枚举，其中的一个：

** 暂态
**  {PERSISTENT {1}} |  {TRANSIENT {3}}
| 最多突出消息a | 号码 |   |  0  | 
|======================

[[VMMessageAttributes]]
=== 虚拟机消息属性

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 队列名称| 字符串 |   |   | 
| 时间戳a | 日期时间 |   |   | 
|======================

[[RedeliveryPolicy]]
=== 重新送货政策

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|======================
| 字段 | 类型 | 描述 | 默认值 | 必需
| 最大重新送货次数|  Number  | 在触发流程失败消息 |   | 
之前，可以重新传递和处理消息的最大次数
| 使用安全哈希a | 布尔值 | 是否使用安全哈希算法来识别重新发送的邮件 |   | 
| 消息摘要算法a | 字符串 | 要使用的安全哈希算法。如果未设置，则默认值为SHA-256。 |   | 
|  ID表达式a | 字符串 | 定义一个或多个表达式用于确定消息何时被重新传递。如果useSecureHash为false，则只能设置此属性。 |   | 
| 对象存储区|  <<ObjectStore>>  | 将存储每个消息的重新传送计数器的对象存储区。 |   | 
|======================

