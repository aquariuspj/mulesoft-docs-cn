Mule ESB服务器和管理控制台的= 快速入门指南

[TIP]
要评估Mule高可用性集群，请参阅 link:/mule-user-guide/v/3.3/evaluating-mule-high-availability-clusters-demo[评估Mule HA聚类]。

Mule的管理控制台（前端图形界面为Mule ESB服务器提供了一个窗口）使您可以在服务器上部署应用程序并在稍后进行监视和维护。本主题显示了在Mule服务器上启动并运行应用程序并监视其消息流是多么容易。

注意：本页假定您已下载并安装捆绑的Mule ESB Enterprise Runtime（使用管理工具）。如果您尚未下载该软件包，可以从 http://www.mulesoft.com/managing-mule-esb-enterprise[这里]进行。

本页面分步介绍以下任务和主题：

一旦您知道如何运行应用程序并分析其流程，就可以了解使用管理控制台可以执行的其他一些任务：

*  link:/mule-management-console/v/3.3/adding-and-managing-alerts-and-slas[添加和管理警报和SLA]
*  link:/mule-management-console/v/3.3/monitoring-and-debugging-applications[监视和调试应用程序]
*  link:/mule-management-console/v/3.3/setting-up-users[设置用户]

== 启动Mule服务器

如果尚未启动服务器，请运行位于解压缩软件包所在位置下方的`\bin`目录中的`mule`文件。

例如，在Windows平台上，打开命令窗口并导航到Mule `\bin`目录。从`\bin`目录中键入`mule`，从命令行启动Mule服务器。运行`mule.bat`也会启动服务器。

您应该在命令窗口中看到一系列启动消息。当服务器完成其启动时，您可能会看到一条消息，指示服务器托管Web应用程序。虽然在下图中没有显示，但该消息也可能指示URL，例如

`+http://0.0.0.0:8585/mmc+`

要么

`+http://localhost:8585/mmc+`

，指向浏览器登录。通过浏览器登录将在下一步中介绍。

image:url-location.png[网址定位]

== 打开控制台并登录

服务器启动并运行后，将浏览器指向URL

HTTP：//本地主机：8585 / MMC

显示登录屏幕。

image:mmc-login-1.png[MMC-登录-1]

使用以下凭据登录：

username = `admin` password = `admin`

由于您使用的是捆绑分发，因此服务器会自动在控制台中注册。首次登录时显示的控制台“仪表板”屏幕表示没有要注册的服务器。您可以点击信息中心上的图标（本质上为"quick start"部分）移至其他控制台窗格，或者只需关闭仪表板即可查看服务器状态和运行状况摘要。

== 注册服务器

注册服务器的最简单方法是使用控制台的自动发现功能：控制台会自动感知Mule服务器正在运行，捕获注册所需的大部分信息，因此可以轻松注册任何"discovered"服务器。

单击服务器选项卡，然后单击左侧导航窗格中的未注册节点。该窗口列出所有已联机且尚未注册的服务器。选择要注册的服务器，然后单击注册按钮。您无需指定服务器的URL，因为自动发现功能为您完成此操作。 （有关更多信息，请参阅 link:/mule-management-console/v/3.3/working-with-mule-server-instances[自动发现新服务器]。）

您也可以手动注册一个服务器。为此，请单击服务器选项卡，然后单击新建服务器按钮。在打开的对话框中，输入服务器的名称和服务器的URL地址。 （请参阅 link:/mule-management-console/v/3.3/working-with-mule-server-instances[手动注册服务器]。）

== 查找示例应用程序

Mule服务器软件包中包含的示例应用程序位于`\examples`文件夹中的Mule安装文件夹下。打开`\examples`文件夹，您应该会看到一组文件夹，例如`\hello`，`\loanbroker-simple`，`\stockquote`等等。

[WARNING]
示例应用程序预先加载到服务器存储库中。

为了说明，假设您将服务器软件包安装在文件夹`\mule-esb`中。打开此安装文件夹，然后打开`\examples`文件夹。您应该看到一组类似于下图的文件夹：

image:examples-folder2.png[例子 - 文件夹2]

`\examples`中的每个文件夹都包含该特定示例应用程序所需的所有文件，以及一个包含特定指令的README.txt文件以运行该示例。以下是hello应用程序文件夹的内容：

image:hello-example-folder2.png[你好-示例-文件夹2]

要使用示例应用程序，请将示例的存档或包含所有应用程序组件的`.zip`文件部署到服务器。除非在自述文件中另有说明，否则示例应用程序已构建并准备好进行部署和运行。您将存档文件`.zip`文件部署到Mule服务器。对于hello示例，这是`mule-example-hello-3.2.0.zip`文件。

[NOTE]
术语*application*（在Mule ESB环境中）是指将一个或多个流打包到一起管理的部署单元中。通常，单个应用程序打包共享共同开发生命周期和/或通用组件的流程。这些组件打包到归档文件中，通常是`.zip`文件。部署应用程序时，实际上会部署此存档文件。

当您查看其他示例应用程序文件夹时，请注意这些文件集与hello应用程序文件夹相似。如果你刚刚开始，你可能想尝试使用hello应用程序，因为它是最简单的例子。

== 部署应用程序

一旦服务器被注册，您就可以部署应用程序。要开始，您可以部署其中一个示例应用程序，例如hello示例。

单击控制台窗口中的“应用程序”选项卡以打开“所有部署”窗口。

image:all-deployments2.png[全deployments2]

没有应用程序部署到此服务器，因此单击新建以创建新的部署。

您需要为部署创建一个名称，以便以后可以识别它。

* 在“部署名称”字段中，输入名称，例如HelloExample。 （请参见下图。请注意，上传应用程序按钮以及用于选择部署服务器的下拉箭头。）

image:deploy-app2.png[部署，APP2]

您可以部署已添加到服务器存储库的应用程序或从系统上载Web应用程序。由于存储库中没有应用程序，因此请从分发示例文件夹中上传hello应用程序。

* 点击上传新应用程序按钮。
* 打开一个对话框，通过它可以浏览到应用程序文件。
* 使用浏览对话框找到安装Mule服务器和控制台的文件夹，然后浏览到\ examples \ hello文件夹。选择hello应用程序ZIP文件：`mule-example-hello-3.2.0.zip`。
* 展开对话框下半部分的“高级选项”以进一步指定工作区文件夹，应用程序的名称（如您希望它在服务器上部署时显示在控制台中）以及应用程序版本号。在本例中，工作区文件夹是/ Applications，部署名称是helloApp，版本号更改为3.2。

image:add-application2.png[附加应用2]

* 点击添加完成上传。

接下来，指定您希望部署应用程序的一个或多个服务器。

* 使用服务器下的下拉列表选择要部署的服务器。该列表包括已注册的服务器和服务器组。

屏幕应该如下所示：

image:hello-deploy2.png[你好，deploy2]

请注意，您可以一次部署多个应用程序，也可以将这些应用程序部署到一台或多台服务器。单击应用程序右侧的红色X以从部署中删除该应用程序。单击服务器名称右侧的红色X将该服务器从部署列表中删除。

* 单击“部署”将hello应用程序部署到服务器。

您应该在屏幕的上半部分看到一条状态消息，指出正在进行部署。完成后，状态字段将指示部署是否成功。见下图。

image:deploy-status2.png[部署-STATUS2]

如果发生错误，请单击“重新部署”按钮尝试重新部署应用程序。

* 单击“部署”按钮时，应用程序也会保存在服务器存储库中。单击“保存”按钮而不是“部署”，只将应用程序保存到存储库而不进行部署。您可以随时部署应用程序。

在任何时候，您都可以单击Repository节点并查看有关此部署的信息。您还可以单击“部署”节点并返回到“所有部署”屏幕以查看所有部署的列表。从所有部署中，您可以选择特定的部署，然后编辑，取消部署，重新部署或删除它们。

== 运行已部署的应用程序

通过另一个浏览器窗口或选项卡运行部署的hello应用程序。在该浏览器窗口或选项卡中，输入URL

`+http://localhost:8888/?name=Ross+`

（如果需要，请随意使用"Ross"以外的名称。）

浏览器运行已部署的hello示例应用程序，该应用程序只需使用name参数并将其插入到简单的文本行中。浏览器显示应用程序的输出，例如：`Hello Ross, how are you?`

== 验证应用程序的流程细节

运行应用程序后，返回到控制台窗口，并使用“流”选项卡和“流量分析器”选项卡分析应用程序的处理。流量表示应用程序内所有服务和处理的总和，包括路由器，变换器和过滤器。

单击“流”选项卡查看“流”屏幕，该屏幕仅显示组成此hello应用程序的流程。由于只有hello应用程序在一台服务器上运行，因此不需要选择特定的服务器。有三个简单的流程。该表格显示了应用程序处理的事件数量（包括处理事件和接收事件）以及每个流程的平均事件处理时间和总事件处理时间的总结（请参见下图）。

image:audit-flows2.png[审计flows2]

您可以通过此屏幕控制流量。要进行流量分析，请确保应用程序的流程已启动。选中复选框以选择特定流程，然后单击控制流程按钮并选择开始，暂停或停止。如果不适用，选项会变灰。默认情况下，流量通常开始。

单击流程名称以查看有关该流程的更多详细信息。例如，单击Hello World流程名称以打开包含两个选项卡的屏幕。摘要选项卡显示有关此流程的摘要信息。 Endpoints选项卡显示有关流程端点的信息。

摘要显示包括状态数据以及有关流程处理和接收（异步和同步）的不同事件的图形和数据。

image:flows-summary2.png[流-summary2]

下面显示的Endpoints选项卡显示了有关每个端点的流和所有端点的所有端点的表，包括端点类型，地址，连接器信息，是否被过滤，是否同步以及是否处理交易。单击一个或多个端点，然后使用控制端点按钮启动或停止这些端点。

image:flows-endpoints2.png[流-endpoints2]

== 分析应用程序中的消息流

现在，有趣的是看到消息流和hello应用程序的消息有效载荷。

在控制台窗口中，单击“流量分析器”选项卡查看有关消息流的详细信息。流量分析器屏幕显示应用程序的消息列表。在看到这些数据之前，您需要通过此屏幕的左侧窗格指定服务器和应用程序。

首先从“选择服务器”下拉列表中选择服务器。选择服务器后，“应用程序”部分展开并显示在选定服务器上运行的已部署应用程序（部署）。选择部署后，“流”部分将展开并以类似的方式显示适用于所选应用程序的流。例如，下图显示了选择helloApp部署及其流程后屏幕的外观。

image:audit-setup2.png[审计设置2]

单击开始（在上图中圈出）查看消息流。然后，从另一个浏览器窗口再次运行应用程序，甚至多次运行该应用程序。

在控制台窗口中注意，运行应用程序时，Flow Analyzer屏幕的消息列表部分将填充消息数据。屏幕顶部的消息列表列出了应用程序处理的不同消息。该表通过其消息ID标识每条消息，指示处理消息的流程，应用程序，处理消息的时间量以及指示消息处理何时发生的时间戳。

要查看有关消息的详细信息，请单击消息ID。屏幕下半部分的消息详细信息部分显示有关所选消息的更多详细信息。

下图是您可能会看到的有关Hello World流的消息数据的示例。请注意，详细信息窗格将同步到“消息流”窗格中的选定消息处理器。也就是说，“有效负载之前/之后”和“消息属性”窗格显示所选消息处理器的具体数据，在本例中为ChoiceRouter。

image:message-detail2.png[消息detail2]

ChitChat流的消息数据不同，如下图所示：

image:message-detail-chitchat2.png[消息细节chitchat2]

您可以深入了解更多信息。在“消息属性”窗格中，展开入站和出站属性节点以查看特定的消息属性及其之前和之后的值。

image:message-properties2.png[消息properties2]

同样，您可以展开“有效载荷之前”和“有效载荷之后”窗格。

== 集群

管理控制台使您能够创建和管理服务器群集。群集是一组紧密合作的链接服务器。实质上，它是一个由多个节点组成的虚拟服务器。一旦创建并注册了群集，就可以将应用程序部署到该群集并执行上面讨论的所有其他操作。例如，这里是一个说明将应用程序部署到群集的屏幕。

image:deploy_to_cluster.png[deploy_to_cluster]

您可以找到有关使用集群 link:/mule-management-console/v/3.3/managing-mule-high-availability-ha-clusters[这里]的更多信息。

== 商业活动

如果您查看上面“集群”部分的插图，您会注意到管理控制台包含一个标记为“商业活动”的新选项卡。 “商业活动”选项卡使您可以查看Mule服务器上的商业交易和事件，使您可以跟踪和分析特定消息的流动和处置。例如，使用“业务事件”选项卡，您可以对消息流中的故障进行根本原因分析。或者您可以执行合规性测试，并查看过程中的特定步骤是否正确执行。以下屏幕说明如何使用“业务事件”选项卡来发现是否在订单履行过程中正确应用了折扣。

image:custom-event-discount.png[自定义事件，折扣]

屏幕中突出显示的数据对应于捕获特定有效负载信息的自定义事件。此处，列出为"Price"的事件的数据显示客户的折扣等级以及应用折扣之前的价格。列出为"Price After Discount"的事件数据显示应用折扣后的价格。

您可以了解有关使用“商家活动”标签 link:/mule-management-console/v/3.3/analyzing-business-events[这里]的更多信息。

== 从哪里出发

为应用程序设置警报（SLA）是您通过控制台执行的另一项重要任务。 link:/mule-management-console/v/3.3/adding-and-managing-alerts-and-slas[添加和管理警报和SLA]向您展示如何开始提醒。
