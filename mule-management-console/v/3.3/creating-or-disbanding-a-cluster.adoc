= 创建或"Disbanding"（删除）群集

您可以使用管理控制台创建一个或多个群集。您创建的任何群集都必须至少包含两个节点。目前，群集可以配置为最多包含四个节点。您也可以"disband"（即删除）群集。

[NOTES]
创建群集时，您为群集选择的所有节点必须实施相同的Mule ESB版本。如果您需要升级服务器以使其与其他群集节点的Mule ESB版本相匹配，请首先取消注册该服务器，然后将其升级到所需版本的Mule。然后，您可以使用升级的服务器（和其他服务器）作为节点创建群集。

您还可以使用REST API以编程方式创建和解散集群。

== 创建群集

通过执行以下步骤来创建群集：

. 如果这些服务器尚未注册到控制台，请注册要放置在群集中的两台，三台或四台服务器。
. 调出所有服务器窗格。单击服务器选项卡，如有必要，请单击导航窗格中的"All"。点击"All"显示在所有组中注册的服务器。如果您当前正在查看注册在特定组（如开发或测试）中的服务器，则可能需要单击"All"。
. 在所有服务器窗格中，单击添加下拉菜单（右上角的工具栏），然后从菜单选项中选择新建群集。
+
image:add_new_cluster_menu.png[add_new_cluster_menu]

. 在出现的创建群集窗格中，在群集名称框中输入群集的名称。然后，选择并添加两个或更多可用节点到群集。使用向右箭头将选定节点从“可用节点”列表添加到“群集节点”列表。 （使用左箭头从集群中删除节点。）使用“可用节点和集群节点”列表中的“全选/全部取消”按钮选择或取消选择相应列表中的所有项目。完成后，单击左下角的添加按钮以完成操作，或者单击取消取消集群创建。 +
  image:new_cluster_form.png[new_cluster_form]

. 控制台然后显示“所有服务器”窗格。在群集创建过程中，窗格使用"in-progress"图标标记新群集。
+
image:cluster_creation_in_progress.png[cluster_creation_in_progress]
+
尽管用户不明确可见，但管理控制台将票证发送到所有群集节点并重新启动它们。正在进行的指示符指示控制台正在等待节点重新启动。一旦群集节点重新启动，群集即可使用。

请注意，“所有服务器”窗格不会列出群集中的单个节点。相反，它将群集列为一个单元。在上面的示例中，MuleCluster包含多个节点（MuleServer1和MuleServer 2，这些节点未显示）。 MuleServer 3和MuleServer 4是独立的独立服务器。

实际上，您无法管理群集中的单个节点。例如，如果将群集添加到组中，则无法列出组中的单个群集节点。一旦创建了集群，管理控制台就可以轻松地将集群作为一个单元进行管理，并使集群成为管理操作的焦点。

[NOTE]
将服务器作为节点添加到群集时，将删除在服务器上定义的任何警报。但是，您可以在群集节点上创建“服务器停止”或“服务器停止”警报。当群集节点关闭或启动时会引发警报。

== 解散或删除群集

您"disband"（即删除）“所有服务器”窗格中的群集。要解散集群，请在集群列表中选择一个或多个集群，然后单击删除下拉菜单中的解散集群。 +
  image:disband_cluster.png[disband_cluster]

解散群集会取消部署到群集的任何应用程序。构成群集的节点成为独立服务器。

== 手动创建群集

当您使用管理控制台将节点添加到群集时，控制台会将节点发送到该节点并重新启动它（对于群集中已有的任何其他节点，也会这样做）。

或者，您可以通过创建管理控制台为节点创建的相同故障单文件，手动将Mule实例添加到集群，然后重新启动节点。

故障单文件是一个Java属性文件，位于`MULE_HOME/.mule/mule-cluster.properties`。该文件具有以下格式：

[source, code, linenums]
----
mule.clusterSize=CLUSTER_SIZE
mule.clusterSchema=partitioned-sync2backup
mule.clusterId=CLUSTER_ID
mule.clusterNodeId=CLUSTER_NODE_ID
----

哪里：

*  `CLUSTER_SIZE`：群集中的节点数量 - 介于2和4之间的整数。
*  `partitioned-sync2backup`：集群的模式标识（`mule.clusterSchema`）。它必须从字面上指定为`partitioned-sync2backup`。
*  `CLUSTER_ID`：集群的ID。它可以是任何字母数字字符串，并且对于群集中的所有节点必须相同。如果您有多个群集，则每个群集都必须具有唯一的`CLUSTER_ID`。
*  `CLUSTER_NODE_ID`：集群内节点的ID。它可以是1到集群中节点数量之间的任何整数。每个节点的`CLUSTER_NODE_ID`在集群中必须是唯一的。这意味着如果在一个集群中有四个节点，则必须有一个带有+的节点
  `CLUSTER_NODE_ID`为1，其他节点的`CLUSTER_NODE_ID`分别为2,3和4。

[IMPORTANT]
====
*Mixed Management is Not Supported*

如果您手动创建集群，则必须手动管理它。您无法使用管理控制台进行管理。
====
