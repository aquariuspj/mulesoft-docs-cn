= 分析流处理和消息有效负载

使用“流量分析器”选项卡查看和分析流量正在处理的消息的实时信息。此选项卡显示处理之前和之后的消息负载，以及有关消息处理器和消息元数据属性的信息。在尝试分析流程之前，请使用“流程”选项卡确保应用程序流程正在运行。

[WARNING]
流分析不适用于群集。它主要是一个开发时间工具。但是，您可以在运行您计划部署到群集的应用程序的独立服务器上使用它。

了解本页所述的流量分析器屏幕的基础知识后，请按照下面的链接深入探讨此主题：

*  link:/mule-management-console/v/3.2/tracking-flows[跟踪流量]  - 提供有关使用“流”选项卡和设置流跟踪的更多信息，这是流分析的先决条件。
*  link:/mule-management-console/v/3.2/analyzing-message-flows[分析消息流]  - 详细介绍如何使用流量分析器窗格。
*  link:/mule-management-console/v/3.2/debugging-message-processing[调试消息处理]  - 说明调试应用程序消息处理的一般步骤。
*  link:/mule-management-console/v/3.2/debugging-the-loan-broker-example-application[调试贷款代理示例应用程序]  - 显示如何使用控制台流量分析器屏幕查找应用程序逻辑错误。
*  link:/mule-user-guide/v/3.2/routing-message-processors[使用消息处理器来控制消息流]  - 为可用的Mule消息处理器或路由器提供参考信息。

== 选择分析流程

当流量分析仪屏幕第一次打开时，它最初是空的。您首先定义用于选择感兴趣的流的参数。为此，首先选择服务器，然后选择部署在该服务器上的应用程序，然后选择所选应用程序的流以使用消息传递数据填充屏幕。见下图。

image:audit-flows.png[审计流程]

从屏幕左侧的服务器，应用程序和流程选择树中进行选择。首先从下拉列表中选择一台服务器。一旦选择了服务器，您将看到服务器上运行的所有应用程序和流的列表。点击一个或多个（或全部）应用程序。同样，您可以选择一个，几个或全部流量。一旦你做出了这些选择，点击开始按钮开始流程分析过程。

== 查看流程摘要

在做出选择并单击“开始”后，屏幕的顶部显示消息标识符列表，并指出消息所属的应用程序和流程，并显示处理时间和发生时间。

image:audit-messages.png[审计信息]

单击左上角的按钮以开始，停止，暂停（或者在当前暂停的情况下继续），流程分析过程或清除收集的信息。

“消息列表”表显示有关正在分析的流消息的摘要详细信息。它包括以下内容：

*  ID：消息标识符。
* 流程：发生消息的流程。
* 应用程序：发生消息的应用程序。
* 处理时间：处理消息所花费的时间。
*  TimeStamp：消息生成的确切时间。

从消息列表中选择消息（单击消息行上的任意位置），并在窗格的下半部分显示有关消息处理的详细信息，包括有关消息处理器的信息，负载值和详细信息之前和之后以及消息属性。

== 查看流处理器和消息

“消息流”窗格列出处理选定消息的消息处理器。通常，一个消息有多个消息处理器。两个有效载荷窗格（有效载荷之前和有效载荷之后）和消息属性窗格与消息流窗格同步。也就是说，有效负载和属性窗格在“消息流”窗格中显示选定消息处理器的详细数据。

单击消息属性标题栏中的展开箭头图标（带圆圈标记），以打开仅包含入站，出站和调用消息属性的更详细的窗格，如下图所示。使用这些顶层消息属性条目（图中圈出）左侧的向右箭头展开和缩小属性详细信息。 （您也可以直接在窗格下半部分显示消息属性详细信息的位置展开和查看消息属性详细信息。）

image:audit-msg-properties.png[审计MSG-性质]

点击红色的X关闭消息属性的详细视图并返回到完整的审核屏幕。

同样，您可以展开有效载荷窗格之前和之后，您可以在有复杂有效载荷时执行此操作。关闭它们并以相同的方式返回到完整的审核屏幕，方法是单击红色的X.

== 使用流时查看消息有效载荷

分析流时，可以看到为CXF端点使用流的SOAP请求的详细信息。

请记住，分析功能旨在不通过系统移动时修改消息有效载荷。这种设计可确保您的系统始终按照测试方式运行，并且在生产环境中使用时分析功能是安全的。

但是，当您使用流时，分析功能会有所不同。当使用流时，系统不会将流读入内存，因为大消息可能会导致问题。相反，系统传递关于流类型的基本信息。

您可以修改应用程序以使用对象到字节数组的变换器，以便它不使用CXF端点的流。这样做可以避免流和内存造成的限制。以下是此入站终点的示例配置。请注意，相同的配置也适用于出站端点。

[source, xml, linenums]
----
<object-to-byte-array name="ObjectToByteArray"/><cxf:inbound-endpoint address="....." transformer-refs="ObjectToByteArray" response-transformer-refs="ObjectToByteArray"/>
----

link:/mule-management-console/v/3.2/working-with-flows[<<上一页：*使用流程*]

link:/mule-management-console/v/3.2/working-with-alerts[下一步：*使用警报* >>]

